   1              		.cpu cortex-m4
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 4
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 2
  11              		.file	"chvt.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text._vt_init,"ax",%progbits
  16              		.align	1
  17              		.global	_vt_init
  18              		.syntax unified
  19              		.thumb
  20              		.thumb_func
  21              		.fpu softvfp
  23              	_vt_init:
  24              	.LFB248:
  25              		.file 1 "lib/chibios/os/rt/src/chvt.c"
   1:lib/chibios/os/rt/src/chvt.c **** /*
   2:lib/chibios/os/rt/src/chvt.c ****     ChibiOS - Copyright (C) 2006..2016 Giovanni Di Sirio.
   3:lib/chibios/os/rt/src/chvt.c **** 
   4:lib/chibios/os/rt/src/chvt.c ****     This file is part of ChibiOS.
   5:lib/chibios/os/rt/src/chvt.c **** 
   6:lib/chibios/os/rt/src/chvt.c ****     ChibiOS is free software; you can redistribute it and/or modify
   7:lib/chibios/os/rt/src/chvt.c ****     it under the terms of the GNU General Public License as published by
   8:lib/chibios/os/rt/src/chvt.c ****     the Free Software Foundation; either version 3 of the License, or
   9:lib/chibios/os/rt/src/chvt.c ****     (at your option) any later version.
  10:lib/chibios/os/rt/src/chvt.c **** 
  11:lib/chibios/os/rt/src/chvt.c ****     ChibiOS is distributed in the hope that it will be useful,
  12:lib/chibios/os/rt/src/chvt.c ****     but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:lib/chibios/os/rt/src/chvt.c ****     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:lib/chibios/os/rt/src/chvt.c ****     GNU General Public License for more details.
  15:lib/chibios/os/rt/src/chvt.c **** 
  16:lib/chibios/os/rt/src/chvt.c ****     You should have received a copy of the GNU General Public License
  17:lib/chibios/os/rt/src/chvt.c ****     along with this program.  If not, see <http://www.gnu.org/licenses/>.
  18:lib/chibios/os/rt/src/chvt.c **** */
  19:lib/chibios/os/rt/src/chvt.c **** 
  20:lib/chibios/os/rt/src/chvt.c **** /**
  21:lib/chibios/os/rt/src/chvt.c ****  * @file    chvt.c
  22:lib/chibios/os/rt/src/chvt.c ****  * @brief   Time and Virtual Timers module code.
  23:lib/chibios/os/rt/src/chvt.c ****  *
  24:lib/chibios/os/rt/src/chvt.c ****  * @addtogroup time
  25:lib/chibios/os/rt/src/chvt.c ****  * @details Time and Virtual Timers related APIs and services.
  26:lib/chibios/os/rt/src/chvt.c ****  * @{
  27:lib/chibios/os/rt/src/chvt.c ****  */
  28:lib/chibios/os/rt/src/chvt.c **** 
  29:lib/chibios/os/rt/src/chvt.c **** #include "ch.h"
  30:lib/chibios/os/rt/src/chvt.c **** 
  31:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  32:lib/chibios/os/rt/src/chvt.c **** /* Module local definitions.                                                 */
  33:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  34:lib/chibios/os/rt/src/chvt.c **** 
  35:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  36:lib/chibios/os/rt/src/chvt.c **** /* Module exported variables.                                                */
  37:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  38:lib/chibios/os/rt/src/chvt.c **** 
  39:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  40:lib/chibios/os/rt/src/chvt.c **** /* Module local types.                                                       */
  41:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  42:lib/chibios/os/rt/src/chvt.c **** 
  43:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  44:lib/chibios/os/rt/src/chvt.c **** /* Module local variables.                                                   */
  45:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  46:lib/chibios/os/rt/src/chvt.c **** 
  47:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  48:lib/chibios/os/rt/src/chvt.c **** /* Module local functions.                                                   */
  49:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  50:lib/chibios/os/rt/src/chvt.c **** 
  51:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  52:lib/chibios/os/rt/src/chvt.c **** /* Module exported functions.                                                */
  53:lib/chibios/os/rt/src/chvt.c **** /*===========================================================================*/
  54:lib/chibios/os/rt/src/chvt.c **** 
  55:lib/chibios/os/rt/src/chvt.c **** /**
  56:lib/chibios/os/rt/src/chvt.c ****  * @brief   Virtual Timers initialization.
  57:lib/chibios/os/rt/src/chvt.c ****  * @note    Internal use only.
  58:lib/chibios/os/rt/src/chvt.c ****  *
  59:lib/chibios/os/rt/src/chvt.c ****  * @notapi
  60:lib/chibios/os/rt/src/chvt.c ****  */
  61:lib/chibios/os/rt/src/chvt.c **** void _vt_init(void) {
  26              		.loc 1 61 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              		@ link register save eliminated.
  62:lib/chibios/os/rt/src/chvt.c **** 
  63:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.next = (virtual_timer_t *)&ch.vtlist;
  31              		.loc 1 63 0
  32 0000 054B     		ldr	r3, .L2
  33 0002 03F11C02 		add	r2, r3, #28
  64:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.prev = (virtual_timer_t *)&ch.vtlist;
  34              		.loc 1 64 0
  35 0006 C3E90722 		strd	r2, r2, [r3, #28]
  65:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.delta = (systime_t)-1;
  66:lib/chibios/os/rt/src/chvt.c **** #if CH_CFG_ST_TIMEDELTA == 0
  67:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.systime = (systime_t)0;
  68:lib/chibios/os/rt/src/chvt.c **** #else /* CH_CFG_ST_TIMEDELTA > 0 */
  69:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.lasttime = (systime_t)0;
  36              		.loc 1 69 0
  37 000a 4FF0FF31 		mov	r1, #-1
  38 000e 0022     		movs	r2, #0
  39 0010 C3E90912 		strd	r1, r2, [r3, #36]
  70:lib/chibios/os/rt/src/chvt.c **** #endif /* CH_CFG_ST_TIMEDELTA > 0 */
  71:lib/chibios/os/rt/src/chvt.c **** }
  40              		.loc 1 71 0
  41 0014 7047     		bx	lr
  42              	.L3:
  43 0016 00BF     		.align	2
  44              	.L2:
  45 0018 00000000 		.word	ch
  46              		.cfi_endproc
  47              	.LFE248:
  49              		.section	.text.chVTDoSetI,"ax",%progbits
  50              		.align	1
  51              		.global	chVTDoSetI
  52              		.syntax unified
  53              		.thumb
  54              		.thumb_func
  55              		.fpu softvfp
  57              	chVTDoSetI:
  58              	.LFB249:
  72:lib/chibios/os/rt/src/chvt.c **** 
  73:lib/chibios/os/rt/src/chvt.c **** /**
  74:lib/chibios/os/rt/src/chvt.c ****  * @brief   Enables a virtual timer.
  75:lib/chibios/os/rt/src/chvt.c ****  * @details The timer is enabled and programmed to trigger after the delay
  76:lib/chibios/os/rt/src/chvt.c ****  *          specified as parameter.
  77:lib/chibios/os/rt/src/chvt.c ****  * @pre     The timer must not be already armed before calling this function.
  78:lib/chibios/os/rt/src/chvt.c ****  * @note    The callback function is invoked from interrupt context.
  79:lib/chibios/os/rt/src/chvt.c ****  *
  80:lib/chibios/os/rt/src/chvt.c ****  * @param[out] vtp      the @p virtual_timer_t structure pointer
  81:lib/chibios/os/rt/src/chvt.c ****  * @param[in] delay     the number of ticks before the operation timeouts, the
  82:lib/chibios/os/rt/src/chvt.c ****  *                      special values are handled as follow:
  83:lib/chibios/os/rt/src/chvt.c ****  *                      - @a TIME_INFINITE is allowed but interpreted as a
  84:lib/chibios/os/rt/src/chvt.c ****  *                        normal time specification.
  85:lib/chibios/os/rt/src/chvt.c ****  *                      - @a TIME_IMMEDIATE this value is not allowed.
  86:lib/chibios/os/rt/src/chvt.c ****  *                      .
  87:lib/chibios/os/rt/src/chvt.c ****  * @param[in] vtfunc    the timer callback function. After invoking the
  88:lib/chibios/os/rt/src/chvt.c ****  *                      callback the timer is disabled and the structure can
  89:lib/chibios/os/rt/src/chvt.c ****  *                      be disposed or reused.
  90:lib/chibios/os/rt/src/chvt.c ****  * @param[in] par       a parameter that will be passed to the callback
  91:lib/chibios/os/rt/src/chvt.c ****  *                      function
  92:lib/chibios/os/rt/src/chvt.c ****  *
  93:lib/chibios/os/rt/src/chvt.c ****  * @iclass
  94:lib/chibios/os/rt/src/chvt.c ****  */
  95:lib/chibios/os/rt/src/chvt.c **** void chVTDoSetI(virtual_timer_t *vtp, systime_t delay,
  96:lib/chibios/os/rt/src/chvt.c ****                 vtfunc_t vtfunc, void *par) {
  59              		.loc 1 96 0
  60              		.cfi_startproc
  61              		@ args = 0, pretend = 0, frame = 0
  62              		@ frame_needed = 0, uses_anonymous_args = 0
  63              	.LVL0:
  64 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
  65              		.cfi_def_cfa_offset 24
  66              		.cfi_offset 3, -24
  67              		.cfi_offset 4, -20
  68              		.cfi_offset 5, -16
  69              		.cfi_offset 6, -12
  70              		.cfi_offset 7, -8
  71              		.cfi_offset 14, -4
  97:lib/chibios/os/rt/src/chvt.c ****   virtual_timer_t *p;
  98:lib/chibios/os/rt/src/chvt.c ****   systime_t delta;
  99:lib/chibios/os/rt/src/chvt.c **** 
 100:lib/chibios/os/rt/src/chvt.c ****   chDbgCheckClassI();
 101:lib/chibios/os/rt/src/chvt.c ****   chDbgCheck((vtp != NULL) && (vtfunc != NULL) && (delay != TIME_IMMEDIATE));
 102:lib/chibios/os/rt/src/chvt.c **** 
 103:lib/chibios/os/rt/src/chvt.c ****   vtp->par = par;
 104:lib/chibios/os/rt/src/chvt.c ****   vtp->func = vtfunc;
  72              		.loc 1 104 0
  73 0002 C0E90323 		strd	r2, r3, [r0, #12]
  74              	.LBB27:
 105:lib/chibios/os/rt/src/chvt.c **** 
 106:lib/chibios/os/rt/src/chvt.c **** #if CH_CFG_ST_TIMEDELTA > 0
 107:lib/chibios/os/rt/src/chvt.c ****   {
 108:lib/chibios/os/rt/src/chvt.c ****     systime_t now = chVTGetSystemTimeX();
 109:lib/chibios/os/rt/src/chvt.c **** 
 110:lib/chibios/os/rt/src/chvt.c ****     /* If the requested delay is lower than the minimum safe delta then it
 111:lib/chibios/os/rt/src/chvt.c ****        is raised to the minimum safe value.*/
 112:lib/chibios/os/rt/src/chvt.c ****     if (delay < (systime_t)CH_CFG_ST_TIMEDELTA) {
 113:lib/chibios/os/rt/src/chvt.c ****       delay = (systime_t)CH_CFG_ST_TIMEDELTA;
 114:lib/chibios/os/rt/src/chvt.c ****     }
 115:lib/chibios/os/rt/src/chvt.c **** 
 116:lib/chibios/os/rt/src/chvt.c ****     /* Special case where the timers list is empty.*/
 117:lib/chibios/os/rt/src/chvt.c ****     if (&ch.vtlist == (virtual_timers_list_t *)ch.vtlist.next) {
  75              		.loc 1 117 0
  76 0006 1B4A     		ldr	r2, .L12
  77              	.LVL1:
  78              	.LBE27:
  96:lib/chibios/os/rt/src/chvt.c ****   virtual_timer_t *p;
  79              		.loc 1 96 0
  80 0008 0646     		mov	r6, r0
  81              	.LBB42:
  82              		.loc 1 117 0
  83 000a 1046     		mov	r0, r2
  84              	.LVL2:
  85 000c 0229     		cmp	r1, #2
  86 000e 50F81C5F 		ldr	r5, [r0, #28]!
  87              	.LBB28:
  88              	.LBB29:
  89              	.LBB30:
  90              	.LBB31:
  91              		.file 2 "./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h"
   1:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*
   2:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     ChibiOS - Copyright (C) 2006..2016 Giovanni Di Sirio
   3:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
   4:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     Licensed under the Apache License, Version 2.0 (the "License");
   5:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     you may not use this file except in compliance with the License.
   6:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     You may obtain a copy of the License at
   7:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
   8:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****         http://www.apache.org/licenses/LICENSE-2.0
   9:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  10:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     Unless required by applicable law or agreed to in writing, software
  11:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     distributed under the License is distributed on an "AS IS" BASIS,
  12:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  13:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     See the License for the specific language governing permissions and
  14:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****     limitations under the License.
  15:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** */
  16:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  17:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /**
  18:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @file    TIMv1/hal_st_lld.h
  19:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @brief   ST Driver subsystem low level driver header.
  20:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @details This header is designed to be include-able without having to
  21:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  *          include other files from the HAL.
  22:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  *
  23:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @addtogroup ST
  24:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @{
  25:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  */
  26:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  27:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #ifndef HAL_ST_LLD_H
  28:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define HAL_ST_LLD_H
  29:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  30:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #include "mcuconf.h"
  31:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #include "stm32_registry.h"
  32:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #include "stm32_tim.h"
  33:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  34:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
  35:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /* Driver constants.                                                         */
  36:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
  37:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  38:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
  39:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /* Driver pre-compile time settings.                                         */
  40:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
  41:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  42:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /**
  43:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @name    Configuration options
  44:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @{
  45:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  */
  46:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /**
  47:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @brief   SysTick timer IRQ priority.
  48:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  */
  49:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if !defined(STM32_ST_IRQ_PRIORITY) || defined(__DOXYGEN__)
  50:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define STM32_ST_IRQ_PRIORITY               8
  51:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
  52:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  53:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /**
  54:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @brief   TIMx unit (by number) to be used for free running operations.
  55:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @note    You must select a 32 bits timer if a 32 bits @p systick_t type
  56:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  *          is required.
  57:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @note    Timers 2, 3, 4 and 5 are supported.
  58:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  */
  59:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if !defined(STM32_ST_USE_TIMER) || defined(__DOXYGEN__)
  60:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define STM32_ST_USE_TIMER                  2
  61:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
  62:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /** @} */
  63:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  64:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
  65:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /* Derived constants and error checks.                                       */
  66:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
  67:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  68:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if STM32_ST_USE_TIMER == 2
  69:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if !STM32_HAS_TIM2
  70:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #error "TIM2 not present"
  71:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
  72:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define STM32_ST_TIM                              STM32_TIM2
  73:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  74:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #elif STM32_ST_USE_TIMER == 3
  75:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if !STM32_HAS_TIM3
  76:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #error "TIM3 not present"
  77:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
  78:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define STM32_ST_TIM                              STM32_TIM3
  79:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  80:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #elif STM32_ST_USE_TIMER == 4
  81:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if !STM32_HAS_TIM4
  82:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #error "TIM4 not present"
  83:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
  84:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define STM32_ST_TIM                              STM32_TIM4
  85:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  86:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #elif STM32_ST_USE_TIMER == 5
  87:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if !STM32_HAS_TIM5
  88:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #error "TIM5 not present"
  89:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
  90:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define STM32_ST_TIM                              STM32_TIM5
  91:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  92:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #elif STM32_ST_USE_TIMER == 21
  93:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if !STM32_HAS_TIM21
  94:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #error "TIM21 not present"
  95:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
  96:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define STM32_ST_TIM                              STM32_TIM21
  97:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
  98:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #elif STM32_ST_USE_TIMER == 22
  99:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #if !STM32_HAS_TIM22
 100:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #error "TIM22 not present"
 101:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
 102:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #define STM32_ST_TIM                              STM32_TIM22
 103:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
 104:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #else
 105:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #error "STM32_ST_USE_TIMER specifies an unsupported timer"
 106:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
 107:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
 108:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
 109:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /* Driver data structures and types.                                         */
 110:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
 111:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
 112:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
 113:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /* Driver macros.                                                            */
 114:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
 115:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
 116:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
 117:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /* External declarations.                                                    */
 118:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
 119:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
 120:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #ifdef __cplusplus
 121:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** extern "C" {
 122:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
 123:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****   void st_lld_init(void);
 124:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #ifdef __cplusplus
 125:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** }
 126:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** #endif
 127:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
 128:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
 129:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /* Driver inline functions.                                                  */
 130:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /*===========================================================================*/
 131:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
 132:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** /**
 133:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @brief   Returns the time counter value.
 134:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  *
 135:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @return              The counter value.
 136:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  *
 137:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  * @notapi
 138:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****  */
 139:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** static inline systime_t st_lld_get_counter(void) {
 140:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h **** 
 141:./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/hal_st_lld.h ****   return (systime_t)STM32_ST_TIM->CNT;
  92              		.loc 2 141 0
  93 0012 4FF08043 		mov	r3, #1073741824
  94              	.LVL3:
  95 0016 38BF     		it	cc
  96 0018 0221     		movcc	r1, #2
  97              	.LVL4:
  98              	.LBE31:
  99              	.LBE30:
 100              	.LBE29:
 101              	.LBE28:
 102              		.loc 1 117 0
 103 001a 8542     		cmp	r5, r0
 104              	.LBB35:
 105              	.LBB34:
 106              	.LBB33:
 107              	.LBB32:
 108              		.loc 2 141 0
 109 001c 5B6A     		ldr	r3, [r3, #36]
 110              	.LVL5:
 111 001e 1746     		mov	r7, r2
 112              	.LBE32:
 113              	.LBE33:
 114              	.LBE34:
 115              	.LBE35:
 116              		.loc 1 117 0
 117 0020 0AD1     		bne	.L5
 118:lib/chibios/os/rt/src/chvt.c **** 
 119:lib/chibios/os/rt/src/chvt.c ****       /* The delta list is empty, the current time becomes the new
 120:lib/chibios/os/rt/src/chvt.c ****          delta list base time, the timer is inserted.*/
 121:lib/chibios/os/rt/src/chvt.c ****       ch.vtlist.lasttime = now;
 118              		.loc 1 121 0
 119 0022 9362     		str	r3, [r2, #40]
 122:lib/chibios/os/rt/src/chvt.c ****       ch.vtlist.next = vtp;
 123:lib/chibios/os/rt/src/chvt.c ****       ch.vtlist.prev = vtp;
 120              		.loc 1 123 0
 121 0024 C2E90766 		strd	r6, r6, [r2, #28]
 122              	.LBB36:
 123              	.LBB37:
 124              		.file 3 "./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h"
   1:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*
   2:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     ChibiOS - Copyright (C) 2006..2016 Giovanni Di Sirio.
   3:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
   4:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     This file is part of ChibiOS.
   5:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
   6:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     ChibiOS is free software; you can redistribute it and/or modify
   7:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     it under the terms of the GNU General Public License as published by
   8:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     the Free Software Foundation; either version 3 of the License, or
   9:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     (at your option) any later version.
  10:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  11:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     ChibiOS is distributed in the hope that it will be useful,
  12:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     GNU General Public License for more details.
  15:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  16:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     You should have received a copy of the GNU General Public License
  17:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****     along with this program.  If not, see <http://www.gnu.org/licenses/>.
  18:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** */
  19:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  20:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /**
  21:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @file    chcore_timer.h
  22:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @brief   System timer header file.
  23:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  *
  24:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @addtogroup ARMCMx_TIMER
  25:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @{
  26:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  */
  27:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  28:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** #ifndef CHCORE_TIMER_H
  29:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** #define CHCORE_TIMER_H
  30:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  31:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /* This is the only header in the HAL designed to be include-able alone.*/
  32:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** #include "hal_st.h"
  33:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  34:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  35:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /* Module constants.                                                         */
  36:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  37:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  38:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  39:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /* Module pre-compile time settings.                                         */
  40:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  41:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  42:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  43:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /* Derived constants and error checks.                                       */
  44:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  45:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  46:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  47:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /* Module data structures and types.                                         */
  48:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  49:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  50:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  51:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /* Module macros.                                                            */
  52:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  53:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  54:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  55:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /* External declarations.                                                    */
  56:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  57:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  58:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  59:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /* Module inline functions.                                                  */
  60:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /*===========================================================================*/
  61:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  62:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /**
  63:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @brief   Starts the alarm.
  64:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @note    Makes sure that no spurious alarms are triggered after
  65:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  *          this call.
  66:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  *
  67:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @param[in] time      the time to be set for the first alarm
  68:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  *
  69:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @notapi
  70:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  */
  71:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** static inline void port_timer_start_alarm(systime_t time) {
  72:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  73:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****   stStartAlarm(time);
 125              		.loc 3 73 0
 126 0028 5818     		adds	r0, r3, r1
 127              	.LBE37:
 128              	.LBE36:
 124:lib/chibios/os/rt/src/chvt.c ****       vtp->next = (virtual_timer_t *)&ch.vtlist;
 125:lib/chibios/os/rt/src/chvt.c ****       vtp->prev = (virtual_timer_t *)&ch.vtlist;
 129              		.loc 1 125 0
 130 002a C6E90055 		strd	r5, r5, [r6]
 126:lib/chibios/os/rt/src/chvt.c ****       vtp->delta = delay;
 131              		.loc 1 126 0
 132 002e B160     		str	r1, [r6, #8]
 133              	.LVL6:
 134              	.LBE42:
 127:lib/chibios/os/rt/src/chvt.c **** 
 128:lib/chibios/os/rt/src/chvt.c ****       /* Being the first element in the list the alarm timer is started.*/
 129:lib/chibios/os/rt/src/chvt.c ****       port_timer_start_alarm(ch.vtlist.lasttime + delay);
 130:lib/chibios/os/rt/src/chvt.c **** 
 131:lib/chibios/os/rt/src/chvt.c ****       return;
 132:lib/chibios/os/rt/src/chvt.c ****     }
 133:lib/chibios/os/rt/src/chvt.c **** 
 134:lib/chibios/os/rt/src/chvt.c ****     /* Pointer to the first element in the delta list, which is non-empty.*/
 135:lib/chibios/os/rt/src/chvt.c ****     p = ch.vtlist.next;
 136:lib/chibios/os/rt/src/chvt.c **** 
 137:lib/chibios/os/rt/src/chvt.c ****     /* Delay as delta from 'lasttime'. Note, it can overflow and the value
 138:lib/chibios/os/rt/src/chvt.c ****        becomes lower than 'now'.*/
 139:lib/chibios/os/rt/src/chvt.c ****     delta = now - ch.vtlist.lasttime + delay;
 140:lib/chibios/os/rt/src/chvt.c **** 
 141:lib/chibios/os/rt/src/chvt.c ****     if (delta < now - ch.vtlist.lasttime) {
 142:lib/chibios/os/rt/src/chvt.c ****       /* Scenario where a very large delay excedeed the numeric range, it
 143:lib/chibios/os/rt/src/chvt.c ****          requires a special handling. We need to skip the first element and
 144:lib/chibios/os/rt/src/chvt.c ****          adjust the delta to wrap back in the previous numeric range.*/
 145:lib/chibios/os/rt/src/chvt.c ****       delta -= p->delta;
 146:lib/chibios/os/rt/src/chvt.c ****       p = p->next;
 147:lib/chibios/os/rt/src/chvt.c ****     }
 148:lib/chibios/os/rt/src/chvt.c ****     else if (delta < p->delta) {
 149:lib/chibios/os/rt/src/chvt.c ****      /* A small delay that will become the first element in the delta list
 150:lib/chibios/os/rt/src/chvt.c ****         and next deadline.*/
 151:lib/chibios/os/rt/src/chvt.c ****       port_timer_set_alarm(ch.vtlist.lasttime + delta);
 152:lib/chibios/os/rt/src/chvt.c ****     }
 153:lib/chibios/os/rt/src/chvt.c ****   }
 154:lib/chibios/os/rt/src/chvt.c **** #else /* CH_CFG_ST_TIMEDELTA == 0 */
 155:lib/chibios/os/rt/src/chvt.c ****   /* Delta is initially equal to the specified delay.*/
 156:lib/chibios/os/rt/src/chvt.c ****   delta = delay;
 157:lib/chibios/os/rt/src/chvt.c **** 
 158:lib/chibios/os/rt/src/chvt.c ****   /* Pointer to the first element in the delta list.*/
 159:lib/chibios/os/rt/src/chvt.c ****   p = ch.vtlist.next;
 160:lib/chibios/os/rt/src/chvt.c **** #endif /* CH_CFG_ST_TIMEDELTA == 0 */
 161:lib/chibios/os/rt/src/chvt.c **** 
 162:lib/chibios/os/rt/src/chvt.c ****   /* The delta list is scanned in order to find the correct position for
 163:lib/chibios/os/rt/src/chvt.c ****      this timer. */
 164:lib/chibios/os/rt/src/chvt.c ****   while (p->delta < delta) {
 165:lib/chibios/os/rt/src/chvt.c ****     /* Debug assert if the timer is already in the list.*/
 166:lib/chibios/os/rt/src/chvt.c ****     chDbgAssert(p != vtp, "timer already armed");
 167:lib/chibios/os/rt/src/chvt.c **** 
 168:lib/chibios/os/rt/src/chvt.c ****     delta -= p->delta;
 169:lib/chibios/os/rt/src/chvt.c ****     p = p->next;
 170:lib/chibios/os/rt/src/chvt.c ****   }
 171:lib/chibios/os/rt/src/chvt.c **** 
 172:lib/chibios/os/rt/src/chvt.c ****   /* The timer is inserted in the delta list.*/
 173:lib/chibios/os/rt/src/chvt.c ****   vtp->next = p;
 174:lib/chibios/os/rt/src/chvt.c ****   vtp->prev = vtp->next->prev;
 175:lib/chibios/os/rt/src/chvt.c ****   vtp->prev->next = vtp;
 176:lib/chibios/os/rt/src/chvt.c ****   p->prev = vtp;
 177:lib/chibios/os/rt/src/chvt.c ****   vtp->delta = delta;
 178:lib/chibios/os/rt/src/chvt.c **** 
 179:lib/chibios/os/rt/src/chvt.c ****   /* Calculate new delta for the following entry.*/
 180:lib/chibios/os/rt/src/chvt.c ****   p->delta -= delta;
 181:lib/chibios/os/rt/src/chvt.c **** 
 182:lib/chibios/os/rt/src/chvt.c ****   /* Special case when the timer is in last position in the list, the
 183:lib/chibios/os/rt/src/chvt.c ****      value in the header must be restored.*/
 184:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.delta = (systime_t)-1;
 185:lib/chibios/os/rt/src/chvt.c **** }
 135              		.loc 1 185 0
 136 0030 BDE8F840 		pop	{r3, r4, r5, r6, r7, lr}
 137              		.cfi_remember_state
 138              		.cfi_restore 14
 139              		.cfi_restore 7
 140              		.cfi_restore 6
 141              		.cfi_restore 5
 142              		.cfi_restore 4
 143              		.cfi_restore 3
 144              		.cfi_def_cfa_offset 0
 145              	.LVL7:
 146              	.LBB43:
 147              	.LBB39:
 148              	.LBB38:
 149              		.loc 3 73 0
 150 0034 FFF7FEBF 		b	stStartAlarm
 151              	.LVL8:
 152              	.L5:
 153              		.cfi_restore_state
 154              	.LBE38:
 155              	.LBE39:
 139:lib/chibios/os/rt/src/chvt.c **** 
 156              		.loc 1 139 0
 157 0038 906A     		ldr	r0, [r2, #40]
 158 003a 1B1A     		subs	r3, r3, r0
 159 003c 5C18     		adds	r4, r3, r1
 160              	.LVL9:
 161 003e AB68     		ldr	r3, [r5, #8]
 141:lib/chibios/os/rt/src/chvt.c ****       /* Scenario where a very large delay excedeed the numeric range, it
 162              		.loc 1 141 0
 163 0040 02D3     		bcc	.L8
 164              	.LVL10:
 165              	.L11:
 166              	.LBE43:
 168:lib/chibios/os/rt/src/chvt.c ****     p = p->next;
 167              		.loc 1 168 0
 168 0042 E41A     		subs	r4, r4, r3
 169              	.LVL11:
 169:lib/chibios/os/rt/src/chvt.c ****   }
 170              		.loc 1 169 0
 171 0044 2D68     		ldr	r5, [r5]
 172              	.LVL12:
 173 0046 04E0     		b	.L10
 174              	.LVL13:
 175              	.L8:
 176              	.LBB44:
 148:lib/chibios/os/rt/src/chvt.c ****      /* A small delay that will become the first element in the delta list
 177              		.loc 1 148 0
 178 0048 A342     		cmp	r3, r4
 179 004a 02D9     		bls	.L10
 180              	.LVL14:
 181              	.LBB40:
 182              	.LBB41:
  74:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** }
  75:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  76:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /**
  77:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @brief   Stops the alarm interrupt.
  78:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  *
  79:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @notapi
  80:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  */
  81:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** static inline void port_timer_stop_alarm(void) {
  82:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  83:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****   stStopAlarm();
  84:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** }
  85:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  86:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** /**
  87:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @brief   Sets the alarm time.
  88:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  *
  89:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @param[in] time      the time to be set for the next alarm
  90:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  *
  91:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  * @notapi
  92:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****  */
  93:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** static inline void port_timer_set_alarm(systime_t time) {
  94:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** 
  95:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h ****   stSetAlarm(time);
 183              		.loc 3 95 0
 184 004c 2044     		add	r0, r0, r4
 185              	.LVL15:
 186 004e FFF7FEFF 		bl	stSetAlarm
 187              	.LVL16:
 188              	.L10:
 189              	.LBE41:
 190              	.LBE40:
 191              	.LBE44:
 164:lib/chibios/os/rt/src/chvt.c ****     /* Debug assert if the timer is already in the list.*/
 192              		.loc 1 164 0
 193 0052 AB68     		ldr	r3, [r5, #8]
 194 0054 A342     		cmp	r3, r4
 195 0056 F4D3     		bcc	.L11
 174:lib/chibios/os/rt/src/chvt.c ****   vtp->prev->next = vtp;
 196              		.loc 1 174 0
 197 0058 6B68     		ldr	r3, [r5, #4]
 198 005a 7360     		str	r3, [r6, #4]
 173:lib/chibios/os/rt/src/chvt.c ****   vtp->prev = vtp->next->prev;
 199              		.loc 1 173 0
 200 005c 3560     		str	r5, [r6]
 175:lib/chibios/os/rt/src/chvt.c ****   p->prev = vtp;
 201              		.loc 1 175 0
 202 005e 1E60     		str	r6, [r3]
 176:lib/chibios/os/rt/src/chvt.c ****   vtp->delta = delta;
 203              		.loc 1 176 0
 204 0060 6E60     		str	r6, [r5, #4]
 177:lib/chibios/os/rt/src/chvt.c **** 
 205              		.loc 1 177 0
 206 0062 B460     		str	r4, [r6, #8]
 180:lib/chibios/os/rt/src/chvt.c **** 
 207              		.loc 1 180 0
 208 0064 AB68     		ldr	r3, [r5, #8]
 209 0066 1C1B     		subs	r4, r3, r4
 210              	.LVL17:
 184:lib/chibios/os/rt/src/chvt.c **** }
 211              		.loc 1 184 0
 212 0068 4FF0FF33 		mov	r3, #-1
 180:lib/chibios/os/rt/src/chvt.c **** 
 213              		.loc 1 180 0
 214 006c AC60     		str	r4, [r5, #8]
 215              	.LVL18:
 184:lib/chibios/os/rt/src/chvt.c **** }
 216              		.loc 1 184 0
 217 006e 7B62     		str	r3, [r7, #36]
 218              		.loc 1 185 0
 219 0070 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 220              	.LVL19:
 221              	.L13:
 222 0072 00BF     		.align	2
 223              	.L12:
 224 0074 00000000 		.word	ch
 225              		.cfi_endproc
 226              	.LFE249:
 228              		.section	.text.chVTDoResetI,"ax",%progbits
 229              		.align	1
 230              		.global	chVTDoResetI
 231              		.syntax unified
 232              		.thumb
 233              		.thumb_func
 234              		.fpu softvfp
 236              	chVTDoResetI:
 237              	.LFB250:
 186:lib/chibios/os/rt/src/chvt.c **** 
 187:lib/chibios/os/rt/src/chvt.c **** /**
 188:lib/chibios/os/rt/src/chvt.c ****  * @brief   Disables a Virtual Timer.
 189:lib/chibios/os/rt/src/chvt.c ****  * @pre     The timer must be in armed state before calling this function.
 190:lib/chibios/os/rt/src/chvt.c ****  *
 191:lib/chibios/os/rt/src/chvt.c ****  * @param[in] vtp       the @p virtual_timer_t structure pointer
 192:lib/chibios/os/rt/src/chvt.c ****  *
 193:lib/chibios/os/rt/src/chvt.c ****  * @iclass
 194:lib/chibios/os/rt/src/chvt.c ****  */
 195:lib/chibios/os/rt/src/chvt.c **** void chVTDoResetI(virtual_timer_t *vtp) {
 238              		.loc 1 195 0
 239              		.cfi_startproc
 240              		@ args = 0, pretend = 0, frame = 0
 241              		@ frame_needed = 0, uses_anonymous_args = 0
 242              		@ link register save eliminated.
 243              	.LVL20:
 244 0000 10B4     		push	{r4}
 245              		.cfi_def_cfa_offset 4
 246              		.cfi_offset 4, -4
 196:lib/chibios/os/rt/src/chvt.c **** 
 197:lib/chibios/os/rt/src/chvt.c ****   chDbgCheckClassI();
 198:lib/chibios/os/rt/src/chvt.c ****   chDbgCheck(vtp != NULL);
 199:lib/chibios/os/rt/src/chvt.c ****   chDbgAssert(vtp->func != NULL, "timer not set or already triggered");
 200:lib/chibios/os/rt/src/chvt.c **** 
 201:lib/chibios/os/rt/src/chvt.c **** #if CH_CFG_ST_TIMEDELTA == 0
 202:lib/chibios/os/rt/src/chvt.c **** 
 203:lib/chibios/os/rt/src/chvt.c ****   /* The delta of the timer is added to the next timer.*/
 204:lib/chibios/os/rt/src/chvt.c ****   vtp->next->delta += vtp->delta;
 205:lib/chibios/os/rt/src/chvt.c **** 
 206:lib/chibios/os/rt/src/chvt.c ****  /* Removing the element from the delta list.*/
 207:lib/chibios/os/rt/src/chvt.c ****   vtp->prev->next = vtp->next;
 208:lib/chibios/os/rt/src/chvt.c ****   vtp->next->prev = vtp->prev;
 209:lib/chibios/os/rt/src/chvt.c ****   vtp->func = NULL;
 210:lib/chibios/os/rt/src/chvt.c **** 
 211:lib/chibios/os/rt/src/chvt.c ****   /* The above code changes the value in the header when the removed element
 212:lib/chibios/os/rt/src/chvt.c ****      is the last of the list, restoring it.*/
 213:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.delta = (systime_t)-1;
 214:lib/chibios/os/rt/src/chvt.c **** #else /* CH_CFG_ST_TIMEDELTA > 0 */
 215:lib/chibios/os/rt/src/chvt.c ****   systime_t nowdelta, delta;
 216:lib/chibios/os/rt/src/chvt.c **** 
 217:lib/chibios/os/rt/src/chvt.c ****   /* If the timer is not the first of the list then it is simply unlinked
 218:lib/chibios/os/rt/src/chvt.c ****      else the operation is more complex.*/
 219:lib/chibios/os/rt/src/chvt.c ****   if (ch.vtlist.next != vtp) {
 247              		.loc 1 219 0
 248 0002 194C     		ldr	r4, .L20
 249 0004 2346     		mov	r3, r4
 250 0006 53F81C1F 		ldr	r1, [r3, #28]!
 251 000a 8142     		cmp	r1, r0
 252 000c 0FD0     		beq	.L15
 220:lib/chibios/os/rt/src/chvt.c ****     /* Removing the element from the delta list.*/
 221:lib/chibios/os/rt/src/chvt.c ****     vtp->prev->next = vtp->next;
 253              		.loc 1 221 0
 254 000e D0E90021 		ldrd	r2, r1, [r0]
 255 0012 0A60     		str	r2, [r1]
 222:lib/chibios/os/rt/src/chvt.c ****     vtp->next->prev = vtp->prev;
 256              		.loc 1 222 0
 257 0014 0268     		ldr	r2, [r0]
 258 0016 5160     		str	r1, [r2, #4]
 223:lib/chibios/os/rt/src/chvt.c ****     vtp->func = NULL;
 224:lib/chibios/os/rt/src/chvt.c **** 
 225:lib/chibios/os/rt/src/chvt.c ****     /* Adding delta to the next element, if it is not the last one.*/
 226:lib/chibios/os/rt/src/chvt.c ****     if (&ch.vtlist != (virtual_timers_list_t *)vtp->next)
 259              		.loc 1 226 0
 260 0018 9A42     		cmp	r2, r3
 223:lib/chibios/os/rt/src/chvt.c ****     vtp->func = NULL;
 261              		.loc 1 223 0
 262 001a 4FF00001 		mov	r1, #0
 263 001e C160     		str	r1, [r0, #12]
 264              		.loc 1 226 0
 265 0020 03D0     		beq	.L14
 227:lib/chibios/os/rt/src/chvt.c ****       vtp->next->delta += vtp->delta;
 266              		.loc 1 227 0
 267 0022 9368     		ldr	r3, [r2, #8]
 268 0024 8168     		ldr	r1, [r0, #8]
 269 0026 0B44     		add	r3, r3, r1
 270 0028 9360     		str	r3, [r2, #8]
 271              	.LVL21:
 272              	.L14:
 228:lib/chibios/os/rt/src/chvt.c **** 
 229:lib/chibios/os/rt/src/chvt.c ****     return;
 230:lib/chibios/os/rt/src/chvt.c ****   }
 231:lib/chibios/os/rt/src/chvt.c **** 
 232:lib/chibios/os/rt/src/chvt.c ****   /* Removing the first timer from the list.*/
 233:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.next = vtp->next;
 234:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.next->prev = (virtual_timer_t *)&ch.vtlist;
 235:lib/chibios/os/rt/src/chvt.c ****   vtp->func = NULL;
 236:lib/chibios/os/rt/src/chvt.c **** 
 237:lib/chibios/os/rt/src/chvt.c ****   /* If the list become empty then the alarm timer is stopped and done.*/
 238:lib/chibios/os/rt/src/chvt.c ****   if (&ch.vtlist == (virtual_timers_list_t *)ch.vtlist.next) {
 239:lib/chibios/os/rt/src/chvt.c ****     port_timer_stop_alarm();
 240:lib/chibios/os/rt/src/chvt.c **** 
 241:lib/chibios/os/rt/src/chvt.c ****     return;
 242:lib/chibios/os/rt/src/chvt.c ****   }
 243:lib/chibios/os/rt/src/chvt.c **** 
 244:lib/chibios/os/rt/src/chvt.c ****   /* The delta of the removed timer is added to the new first timer.*/
 245:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.next->delta += vtp->delta;
 246:lib/chibios/os/rt/src/chvt.c **** 
 247:lib/chibios/os/rt/src/chvt.c ****   /* If the new first timer has a delta of zero then the alarm is not
 248:lib/chibios/os/rt/src/chvt.c ****      modified, the already programmed alarm will serve it.*/
 249:lib/chibios/os/rt/src/chvt.c **** /*  if (ch.vtlist.next->delta == 0) {
 250:lib/chibios/os/rt/src/chvt.c ****     return;
 251:lib/chibios/os/rt/src/chvt.c ****   }*/
 252:lib/chibios/os/rt/src/chvt.c **** 
 253:lib/chibios/os/rt/src/chvt.c ****   /* Distance in ticks between the last alarm event and current time.*/
 254:lib/chibios/os/rt/src/chvt.c ****   nowdelta = chVTGetSystemTimeX() - ch.vtlist.lasttime;
 255:lib/chibios/os/rt/src/chvt.c **** 
 256:lib/chibios/os/rt/src/chvt.c ****   /* If the current time surpassed the time of the next element in list
 257:lib/chibios/os/rt/src/chvt.c ****      then the event interrupt is already pending, just return.*/
 258:lib/chibios/os/rt/src/chvt.c ****   if (nowdelta >= ch.vtlist.next->delta) {
 259:lib/chibios/os/rt/src/chvt.c ****     return;
 260:lib/chibios/os/rt/src/chvt.c ****   }
 261:lib/chibios/os/rt/src/chvt.c **** 
 262:lib/chibios/os/rt/src/chvt.c ****   /* Distance from the next scheduled event and now.*/
 263:lib/chibios/os/rt/src/chvt.c ****   delta = ch.vtlist.next->delta - nowdelta;
 264:lib/chibios/os/rt/src/chvt.c **** 
 265:lib/chibios/os/rt/src/chvt.c ****   /* Making sure to not schedule an event closer than CH_CFG_ST_TIMEDELTA
 266:lib/chibios/os/rt/src/chvt.c ****      ticks from now.*/
 267:lib/chibios/os/rt/src/chvt.c ****   if (delta < (systime_t)CH_CFG_ST_TIMEDELTA) {
 268:lib/chibios/os/rt/src/chvt.c ****     delta = (systime_t)CH_CFG_ST_TIMEDELTA;
 269:lib/chibios/os/rt/src/chvt.c ****   }
 270:lib/chibios/os/rt/src/chvt.c **** 
 271:lib/chibios/os/rt/src/chvt.c ****   port_timer_set_alarm(ch.vtlist.lasttime + nowdelta + delta);
 272:lib/chibios/os/rt/src/chvt.c **** #endif /* CH_CFG_ST_TIMEDELTA > 0 */
 273:lib/chibios/os/rt/src/chvt.c **** }
 273              		.loc 1 273 0
 274 002a 10BC     		pop	{r4}
 275              		.cfi_remember_state
 276              		.cfi_restore 4
 277              		.cfi_def_cfa_offset 0
 278 002c 7047     		bx	lr
 279              	.LVL22:
 280              	.L15:
 281              		.cfi_restore_state
 233:lib/chibios/os/rt/src/chvt.c ****   ch.vtlist.next->prev = (virtual_timer_t *)&ch.vtlist;
 282              		.loc 1 233 0
 283 002e 0A68     		ldr	r2, [r1]
 284 0030 E261     		str	r2, [r4, #28]
 235:lib/chibios/os/rt/src/chvt.c **** 
 285              		.loc 1 235 0
 286 0032 0020     		movs	r0, #0
 287              	.LVL23:
 238:lib/chibios/os/rt/src/chvt.c ****     port_timer_stop_alarm();
 288              		.loc 1 238 0
 289 0034 9A42     		cmp	r2, r3
 234:lib/chibios/os/rt/src/chvt.c ****   vtp->func = NULL;
 290              		.loc 1 234 0
 291 0036 5360     		str	r3, [r2, #4]
 235:lib/chibios/os/rt/src/chvt.c **** 
 292              		.loc 1 235 0
 293 0038 C860     		str	r0, [r1, #12]
 238:lib/chibios/os/rt/src/chvt.c ****     port_timer_stop_alarm();
 294              		.loc 1 238 0
 295 003a 02D1     		bne	.L18
 296              		.loc 1 273 0
 297 003c 10BC     		pop	{r4}
 298              		.cfi_remember_state
 299              		.cfi_restore 4
 300              		.cfi_def_cfa_offset 0
 301              	.LBB45:
 302              	.LBB46:
  83:./lib/chibios/os/common/ports/ARMCMx/chcore_timer.h **** }
 303              		.loc 3 83 0
 304 003e FFF7FEBF 		b	stStopAlarm
 305              	.LVL24:
 306              	.L18:
 307              		.cfi_restore_state
 308              	.LBE46:
 309              	.LBE45:
 245:lib/chibios/os/rt/src/chvt.c **** 
 310              		.loc 1 245 0
 311 0042 9368     		ldr	r3, [r2, #8]
 312 0044 8868     		ldr	r0, [r1, #8]
 313 0046 0344     		add	r3, r3, r0
 314 0048 9360     		str	r3, [r2, #8]
 315              	.LBB47:
 316              	.LBB48:
 317              	.LBB49:
 318              	.LBB50:
 319              		.loc 2 141 0
 320 004a 4FF08042 		mov	r2, #1073741824
 321 004e 506A     		ldr	r0, [r2, #36]
 322              	.LBE50:
 323              	.LBE49:
 324              	.LBE48:
 325              	.LBE47:
 254:lib/chibios/os/rt/src/chvt.c **** 
 326              		.loc 1 254 0
 327 0050 A26A     		ldr	r2, [r4, #40]
 328 0052 821A     		subs	r2, r0, r2
 329              	.LVL25:
 258:lib/chibios/os/rt/src/chvt.c ****     return;
 330              		.loc 1 258 0
 331 0054 9342     		cmp	r3, r2
 332 0056 E8D9     		bls	.L14
 263:lib/chibios/os/rt/src/chvt.c **** 
 333              		.loc 1 263 0
 334 0058 9B1A     		subs	r3, r3, r2
 335              	.LVL26:
 336              	.LBB51:
 337              	.LBB52:
 338              		.loc 3 95 0
 339 005a 022B     		cmp	r3, #2
 340 005c 2CBF     		ite	cs
 341 005e C018     		addcs	r0, r0, r3
 342 0060 0230     		addcc	r0, r0, #2
 343              	.LVL27:
 344              	.LBE52:
 345              	.LBE51:
 346              		.loc 1 273 0
 347 0062 10BC     		pop	{r4}
 348              		.cfi_restore 4
 349              		.cfi_def_cfa_offset 0
 350              	.LBB54:
 351              	.LBB53:
 352              		.loc 3 95 0
 353 0064 FFF7FEBF 		b	stSetAlarm
 354              	.LVL28:
 355              	.L21:
 356              		.align	2
 357              	.L20:
 358 0068 00000000 		.word	ch
 359              	.LBE53:
 360              	.LBE54:
 361              		.cfi_endproc
 362              	.LFE250:
 364              		.text
 365              	.Letext0:
 366              		.file 4 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/machine/_default_types
 367              		.file 5 "/usr/local/Cellar/gcc-arm-none-eabi/20180627/arm-none-eabi/include/sys/_stdint.h"
 368              		.file 6 "./lib/chibios/os/common/ports/ARMCMx/compilers/GCC/chtypes.h"
 369              		.file 7 "./lib/chibios/os/rt/include/chsystypes.h"
 370              		.file 8 "./lib/chibios/os/rt/include/chschd.h"
 371              		.file 9 "./lib/chibios/os/common/ext/CMSIS/include/core_cm4.h"
 372              		.file 10 "./lib/chibios/os/common/ext/CMSIS/ST/STM32F3xx/system_stm32f3xx.h"
 373              		.file 11 "./lib/chibios/os/common/ports/ARMCMx/chcore.h"
 374              		.file 12 "./lib/chibios/os/common/ports/ARMCMx/chcore_v7m.h"
 375              		.file 13 "./lib/chibios/os/hal/ports/STM32/LLD/TIMv1/stm32_tim.h"
 376              		.file 14 "./lib/chibios/os/rt/include/chtm.h"
 377              		.file 15 "./lib/chibios/os/rt/include/chsem.h"
 378              		.file 16 "./lib/chibios/os/rt/include/chmtx.h"
 379              		.file 17 "./lib/chibios/os/rt/include/chsys.h"
 380              		.file 18 "./lib/chibios/os/rt/include/chregistry.h"
 381              		.file 19 "./lib/chibios/os/common/oslib/include/chmemcore.h"
 382              		.file 20 "./lib/chibios/os/rt/include/chvt.h"
 383              		.file 21 "./lib/chibios/os/hal/include/hal_st.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 chvt.c
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:16     .text._vt_init:0000000000000000 $t
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:23     .text._vt_init:0000000000000000 _vt_init
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:45     .text._vt_init:0000000000000018 $d
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:50     .text.chVTDoSetI:0000000000000000 $t
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:57     .text.chVTDoSetI:0000000000000000 chVTDoSetI
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:224    .text.chVTDoSetI:0000000000000074 $d
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:229    .text.chVTDoResetI:0000000000000000 $t
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:236    .text.chVTDoResetI:0000000000000000 chVTDoResetI
/var/folders/qs/3p__ddh573j_6k2216pg8mv40000gn/T//ccTU3ufx.s:358    .text.chVTDoResetI:0000000000000068 $d

UNDEFINED SYMBOLS
ch
stStartAlarm
stSetAlarm
stStopAlarm
