   1               		.file	"ssd1306.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text._send_cmd1,"ax",@progbits
  12               	_send_cmd1:
  13               	.LFB115:
  14               		.file 1 "keyboards/lily58/ssd1306.c"
   1:keyboards/lily58/ssd1306.c **** #ifdef SSD1306OLED
   2:keyboards/lily58/ssd1306.c **** 
   3:keyboards/lily58/ssd1306.c **** #include "ssd1306.h"
   4:keyboards/lily58/ssd1306.c **** #include "i2c.h"
   5:keyboards/lily58/ssd1306.c **** #include <string.h>
   6:keyboards/lily58/ssd1306.c **** #include "print.h"
   7:keyboards/lily58/ssd1306.c **** #ifdef ADAFRUIT_BLE_ENABLE
   8:keyboards/lily58/ssd1306.c **** #include "adafruit_ble.h"
   9:keyboards/lily58/ssd1306.c **** #endif
  10:keyboards/lily58/ssd1306.c **** #ifdef PROTOCOL_LUFA
  11:keyboards/lily58/ssd1306.c **** #include "lufa.h"
  12:keyboards/lily58/ssd1306.c **** #endif
  13:keyboards/lily58/ssd1306.c **** #include "sendchar.h"
  14:keyboards/lily58/ssd1306.c **** #include "timer.h"
  15:keyboards/lily58/ssd1306.c **** 
  16:keyboards/lily58/ssd1306.c **** extern const unsigned char font[] PROGMEM;
  17:keyboards/lily58/ssd1306.c **** 
  18:keyboards/lily58/ssd1306.c **** // Set this to 1 to help diagnose early startup problems
  19:keyboards/lily58/ssd1306.c **** // when testing power-on with ble.  Turn it off otherwise,
  20:keyboards/lily58/ssd1306.c **** // as the latency of printing most of the debug info messes
  21:keyboards/lily58/ssd1306.c **** // with the matrix scan, causing keys to drop.
  22:keyboards/lily58/ssd1306.c **** #define DEBUG_TO_SCREEN 0
  23:keyboards/lily58/ssd1306.c **** 
  24:keyboards/lily58/ssd1306.c **** //static uint16_t last_battery_update;
  25:keyboards/lily58/ssd1306.c **** //static uint32_t vbat;
  26:keyboards/lily58/ssd1306.c **** //#define BatteryUpdateInterval 10000 /* milliseconds */
  27:keyboards/lily58/ssd1306.c **** 
  28:keyboards/lily58/ssd1306.c **** // 'last_flush' is declared as uint16_t,
  29:keyboards/lily58/ssd1306.c **** // so this must be less than 65535 
  30:keyboards/lily58/ssd1306.c **** #define ScreenOffInterval 60000 /* milliseconds */
  31:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
  32:keyboards/lily58/ssd1306.c **** static uint8_t displaying;
  33:keyboards/lily58/ssd1306.c **** #endif
  34:keyboards/lily58/ssd1306.c **** static uint16_t last_flush;
  35:keyboards/lily58/ssd1306.c **** 
  36:keyboards/lily58/ssd1306.c **** static bool force_dirty = true;
  37:keyboards/lily58/ssd1306.c **** 
  38:keyboards/lily58/ssd1306.c **** // Write command sequence.
  39:keyboards/lily58/ssd1306.c **** // Returns true on success.
  40:keyboards/lily58/ssd1306.c **** static inline bool _send_cmd1(uint8_t cmd) {
  15               		.loc 1 40 0
  16               		.cfi_startproc
  17               	.LVL0:
  18 0000 CF93      		push r28
  19               	.LCFI0:
  20               		.cfi_def_cfa_offset 3
  21               		.cfi_offset 28, -2
  22               	/* prologue: function */
  23               	/* frame size = 0 */
  24               	/* stack size = 1 */
  25               	.L__stack_usage = 1
  26 0002 C82F      		mov r28,r24
  27               	.LVL1:
  28               	.LBB16:
  29               	.LBB17:
  30               		.file 2 "keyboards/lily58/i2c.h"
   1:keyboards/lily58/i2c.h **** #pragma once
   2:keyboards/lily58/i2c.h **** 
   3:keyboards/lily58/i2c.h **** #include <stdint.h>
   4:keyboards/lily58/i2c.h **** 
   5:keyboards/lily58/i2c.h **** #ifndef F_CPU
   6:keyboards/lily58/i2c.h **** #define F_CPU 16000000UL
   7:keyboards/lily58/i2c.h **** #endif
   8:keyboards/lily58/i2c.h **** 
   9:keyboards/lily58/i2c.h **** #define I2C_READ 1
  10:keyboards/lily58/i2c.h **** #define I2C_WRITE 0
  11:keyboards/lily58/i2c.h **** 
  12:keyboards/lily58/i2c.h **** #define I2C_ACK 1
  13:keyboards/lily58/i2c.h **** #define I2C_NACK 0
  14:keyboards/lily58/i2c.h **** 
  15:keyboards/lily58/i2c.h **** #define SLAVE_BUFFER_SIZE 0x10
  16:keyboards/lily58/i2c.h **** 
  17:keyboards/lily58/i2c.h **** // i2c SCL clock frequency 400kHz
  18:keyboards/lily58/i2c.h **** #define SCL_CLOCK  400000L
  19:keyboards/lily58/i2c.h **** 
  20:keyboards/lily58/i2c.h **** extern volatile uint8_t i2c_slave_buffer[SLAVE_BUFFER_SIZE];
  21:keyboards/lily58/i2c.h **** 
  22:keyboards/lily58/i2c.h **** void i2c_master_init(void);
  23:keyboards/lily58/i2c.h **** uint8_t i2c_master_start(uint8_t address);
  24:keyboards/lily58/i2c.h **** void i2c_master_stop(void);
  25:keyboards/lily58/i2c.h **** uint8_t i2c_master_write(uint8_t data);
  26:keyboards/lily58/i2c.h **** uint8_t i2c_master_read(int);
  27:keyboards/lily58/i2c.h **** void i2c_reset_state(void);
  28:keyboards/lily58/i2c.h **** void i2c_slave_init(uint8_t address);
  29:keyboards/lily58/i2c.h **** 
  30:keyboards/lily58/i2c.h **** 
  31:keyboards/lily58/i2c.h **** static inline unsigned char i2c_start_read(unsigned char addr) {
  32:keyboards/lily58/i2c.h ****   return i2c_master_start((addr << 1) | I2C_READ);
  33:keyboards/lily58/i2c.h **** }
  34:keyboards/lily58/i2c.h **** 
  35:keyboards/lily58/i2c.h **** static inline unsigned char i2c_start_write(unsigned char addr) {
  36:keyboards/lily58/i2c.h ****   return i2c_master_start((addr << 1) | I2C_WRITE);
  31               		.loc 2 36 0
  32 0004 88E7      		ldi r24,lo8(120)
  33               	.LVL2:
  34 0006 0E94 0000 		call i2c_master_start
  35               	.LVL3:
  36               	.LBE17:
  37               	.LBE16:
  41:keyboards/lily58/ssd1306.c ****   bool res = false;
  42:keyboards/lily58/ssd1306.c **** 
  43:keyboards/lily58/ssd1306.c ****   if (i2c_start_write(SSD1306_ADDRESS)) {
  38               		.loc 1 43 0
  39 000a 8823      		tst r24
  40 000c 01F0      		breq .L2
  41               	.LVL4:
  42               	.L9:
  44:keyboards/lily58/ssd1306.c ****     xprintf("failed to start write to %d\n", SSD1306_ADDRESS);
  45:keyboards/lily58/ssd1306.c ****     goto done;
  46:keyboards/lily58/ssd1306.c ****   }
  47:keyboards/lily58/ssd1306.c **** 
  48:keyboards/lily58/ssd1306.c ****   if (i2c_master_write(0x0 /* command byte follows */)) {
  49:keyboards/lily58/ssd1306.c ****     print("failed to write control byte\n");
  50:keyboards/lily58/ssd1306.c **** 
  51:keyboards/lily58/ssd1306.c ****     goto done;
  52:keyboards/lily58/ssd1306.c ****   }
  53:keyboards/lily58/ssd1306.c **** 
  54:keyboards/lily58/ssd1306.c ****   if (i2c_master_write(cmd)) {
  43               		.loc 1 54 0
  44 000e C0E0      		ldi r28,0
  55:keyboards/lily58/ssd1306.c ****     xprintf("failed to write command %d\n", cmd);
  56:keyboards/lily58/ssd1306.c ****     goto done;
  57:keyboards/lily58/ssd1306.c ****   }
  58:keyboards/lily58/ssd1306.c ****   res = true;
  59:keyboards/lily58/ssd1306.c **** done:
  45               		.loc 1 59 0
  46 0010 00C0      		rjmp .L3
  47               	.LVL5:
  48               	.L2:
  48:keyboards/lily58/ssd1306.c ****     print("failed to write control byte\n");
  49               		.loc 1 48 0
  50 0012 80E0      		ldi r24,0
  51 0014 0E94 0000 		call i2c_master_write
  52               	.LVL6:
  53 0018 8111      		cpse r24,__zero_reg__
  54 001a 00C0      		rjmp .L9
  54:keyboards/lily58/ssd1306.c ****     xprintf("failed to write command %d\n", cmd);
  55               		.loc 1 54 0
  56 001c 8C2F      		mov r24,r28
  57 001e 0E94 0000 		call i2c_master_write
  58               	.LVL7:
  59 0022 C1E0      		ldi r28,lo8(1)
  60               	.LVL8:
  61 0024 8111      		cpse r24,__zero_reg__
  62 0026 00C0      		rjmp .L9
  63               	.L3:
  64               	.LVL9:
  60:keyboards/lily58/ssd1306.c ****   i2c_master_stop();
  65               		.loc 1 60 0
  66 0028 0E94 0000 		call i2c_master_stop
  67               	.LVL10:
  61:keyboards/lily58/ssd1306.c ****   return res;
  62:keyboards/lily58/ssd1306.c **** }
  68               		.loc 1 62 0
  69 002c 8C2F      		mov r24,r28
  70               	/* epilogue start */
  71 002e CF91      		pop r28
  72               	.LVL11:
  73 0030 0895      		ret
  74               		.cfi_endproc
  75               	.LFE115:
  77               		.section	.text._send_cmd2,"ax",@progbits
  79               	_send_cmd2:
  80               	.LFB116:
  63:keyboards/lily58/ssd1306.c **** 
  64:keyboards/lily58/ssd1306.c **** // Write 2-byte command sequence.
  65:keyboards/lily58/ssd1306.c **** // Returns true on success
  66:keyboards/lily58/ssd1306.c **** static inline bool _send_cmd2(uint8_t cmd, uint8_t opr) {
  81               		.loc 1 66 0
  82               		.cfi_startproc
  83               	.LVL12:
  84 0000 CF93      		push r28
  85               	.LCFI1:
  86               		.cfi_def_cfa_offset 3
  87               		.cfi_offset 28, -2
  88               	/* prologue: function */
  89               	/* frame size = 0 */
  90               	/* stack size = 1 */
  91               	.L__stack_usage = 1
  92 0002 C62F      		mov r28,r22
  67:keyboards/lily58/ssd1306.c ****   if (!_send_cmd1(cmd)) {
  93               		.loc 1 67 0
  94 0004 0E94 0000 		call _send_cmd1
  95               	.LVL13:
  96 0008 8823      		tst r24
  97 000a 01F0      		breq .L10
  68:keyboards/lily58/ssd1306.c ****     return false;
  69:keyboards/lily58/ssd1306.c ****   }
  70:keyboards/lily58/ssd1306.c ****   return _send_cmd1(opr);
  98               		.loc 1 70 0
  99 000c 8C2F      		mov r24,r28
 100               	/* epilogue start */
  71:keyboards/lily58/ssd1306.c **** }
 101               		.loc 1 71 0
 102 000e CF91      		pop r28
 103               	.LVL14:
  70:keyboards/lily58/ssd1306.c **** }
 104               		.loc 1 70 0
 105 0010 0C94 0000 		jmp _send_cmd1
 106               	.LVL15:
 107               	.L10:
 108               		.loc 1 71 0
 109 0014 80E0      		ldi r24,0
 110               	/* epilogue start */
 111 0016 CF91      		pop r28
 112               	.LVL16:
 113 0018 0895      		ret
 114               		.cfi_endproc
 115               	.LFE116:
 117               		.section	.text._send_cmd3.constprop.1,"ax",@progbits
 119               	_send_cmd3.constprop.1:
 120               	.LFB139:
  72:keyboards/lily58/ssd1306.c **** 
  73:keyboards/lily58/ssd1306.c **** // Write 3-byte command sequence.
  74:keyboards/lily58/ssd1306.c **** // Returns true on success
  75:keyboards/lily58/ssd1306.c **** static inline bool _send_cmd3(uint8_t cmd, uint8_t opr1, uint8_t opr2) {
 121               		.loc 1 75 0
 122               		.cfi_startproc
 123               	.LVL17:
 124 0000 CF93      		push r28
 125               	.LCFI2:
 126               		.cfi_def_cfa_offset 3
 127               		.cfi_offset 28, -2
 128               	/* prologue: function */
 129               	/* frame size = 0 */
 130               	/* stack size = 1 */
 131               	.L__stack_usage = 1
 132 0002 C62F      		mov r28,r22
 133               	.LVL18:
  76:keyboards/lily58/ssd1306.c ****   if (!_send_cmd1(cmd)) {
 134               		.loc 1 76 0
 135 0004 0E94 0000 		call _send_cmd1
 136               	.LVL19:
 137 0008 8823      		tst r24
 138 000a 01F0      		breq .L14
 139               	.LVL20:
 140               	.LBB20:
 141               	.LBB21:
  77:keyboards/lily58/ssd1306.c ****     return false;
  78:keyboards/lily58/ssd1306.c ****   }
  79:keyboards/lily58/ssd1306.c ****   if (!_send_cmd1(opr1)) {
 142               		.loc 1 79 0
 143 000c 80E0      		ldi r24,0
 144 000e 0E94 0000 		call _send_cmd1
 145               	.LVL21:
 146 0012 8823      		tst r24
 147 0014 01F0      		breq .L14
  80:keyboards/lily58/ssd1306.c ****     return false;
  81:keyboards/lily58/ssd1306.c ****   }
  82:keyboards/lily58/ssd1306.c ****   return _send_cmd1(opr2);
 148               		.loc 1 82 0
 149 0016 8C2F      		mov r24,r28
 150               	/* epilogue start */
 151               	.LBE21:
 152               	.LBE20:
  83:keyboards/lily58/ssd1306.c **** }
 153               		.loc 1 83 0
 154 0018 CF91      		pop r28
 155               	.LVL22:
 156               	.LBB23:
 157               	.LBB22:
  82:keyboards/lily58/ssd1306.c **** }
 158               		.loc 1 82 0
 159 001a 0C94 0000 		jmp _send_cmd1
 160               	.LVL23:
 161               	.L14:
 162               	.LBE22:
 163               	.LBE23:
 164               		.loc 1 83 0
 165 001e 80E0      		ldi r24,0
 166               	/* epilogue start */
 167 0020 CF91      		pop r28
 168               	.LVL24:
 169 0022 0895      		ret
 170               		.cfi_endproc
 171               	.LFE139:
 173               		.section	.text.iota_gfx_off,"ax",@progbits
 174               	.global	iota_gfx_off
 176               	iota_gfx_off:
 177               	.LFB120:
  84:keyboards/lily58/ssd1306.c **** 
  85:keyboards/lily58/ssd1306.c **** #define send_cmd1(c) if (!_send_cmd1(c)) {goto done;}
  86:keyboards/lily58/ssd1306.c **** #define send_cmd2(c,o) if (!_send_cmd2(c,o)) {goto done;}
  87:keyboards/lily58/ssd1306.c **** #define send_cmd3(c,o1,o2) if (!_send_cmd3(c,o1,o2)) {goto done;}
  88:keyboards/lily58/ssd1306.c **** 
  89:keyboards/lily58/ssd1306.c **** static void clear_display(void) {
  90:keyboards/lily58/ssd1306.c ****   matrix_clear(&display);
  91:keyboards/lily58/ssd1306.c **** 
  92:keyboards/lily58/ssd1306.c ****   // Clear all of the display bits (there can be random noise
  93:keyboards/lily58/ssd1306.c ****   // in the RAM on startup)
  94:keyboards/lily58/ssd1306.c ****   send_cmd3(PageAddr, 0, (DisplayHeight / 8) - 1);
  95:keyboards/lily58/ssd1306.c ****   send_cmd3(ColumnAddr, 0, DisplayWidth - 1);
  96:keyboards/lily58/ssd1306.c **** 
  97:keyboards/lily58/ssd1306.c ****   if (i2c_start_write(SSD1306_ADDRESS)) {
  98:keyboards/lily58/ssd1306.c ****     goto done;
  99:keyboards/lily58/ssd1306.c ****   }
 100:keyboards/lily58/ssd1306.c ****   if (i2c_master_write(0x40)) {
 101:keyboards/lily58/ssd1306.c ****     // Data mode
 102:keyboards/lily58/ssd1306.c ****     goto done;
 103:keyboards/lily58/ssd1306.c ****   }
 104:keyboards/lily58/ssd1306.c ****   for (uint8_t row = 0; row < MatrixRows; ++row) {
 105:keyboards/lily58/ssd1306.c ****     for (uint8_t col = 0; col < DisplayWidth; ++col) {
 106:keyboards/lily58/ssd1306.c ****       i2c_master_write(0);
 107:keyboards/lily58/ssd1306.c ****     }
 108:keyboards/lily58/ssd1306.c ****   }
 109:keyboards/lily58/ssd1306.c **** 
 110:keyboards/lily58/ssd1306.c ****   display.dirty = false;
 111:keyboards/lily58/ssd1306.c **** 
 112:keyboards/lily58/ssd1306.c **** done:
 113:keyboards/lily58/ssd1306.c ****   i2c_master_stop();
 114:keyboards/lily58/ssd1306.c **** }
 115:keyboards/lily58/ssd1306.c **** 
 116:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 117:keyboards/lily58/ssd1306.c **** #undef sendchar
 118:keyboards/lily58/ssd1306.c **** static int8_t capture_sendchar(uint8_t c) {
 119:keyboards/lily58/ssd1306.c ****   sendchar(c);
 120:keyboards/lily58/ssd1306.c ****   iota_gfx_write_char(c);
 121:keyboards/lily58/ssd1306.c **** 
 122:keyboards/lily58/ssd1306.c ****   if (!displaying) {
 123:keyboards/lily58/ssd1306.c ****     iota_gfx_flush();
 124:keyboards/lily58/ssd1306.c ****   }
 125:keyboards/lily58/ssd1306.c ****   return 0;
 126:keyboards/lily58/ssd1306.c **** }
 127:keyboards/lily58/ssd1306.c **** #endif
 128:keyboards/lily58/ssd1306.c **** 
 129:keyboards/lily58/ssd1306.c **** bool iota_gfx_init(bool rotate) {
 130:keyboards/lily58/ssd1306.c ****   bool success = false;
 131:keyboards/lily58/ssd1306.c **** 
 132:keyboards/lily58/ssd1306.c ****   i2c_master_init();
 133:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOff);
 134:keyboards/lily58/ssd1306.c ****   send_cmd2(SetDisplayClockDiv, 0x80);
 135:keyboards/lily58/ssd1306.c ****   send_cmd2(SetMultiPlex, DisplayHeight - 1);
 136:keyboards/lily58/ssd1306.c **** 
 137:keyboards/lily58/ssd1306.c ****   send_cmd2(SetDisplayOffset, 0);
 138:keyboards/lily58/ssd1306.c **** 
 139:keyboards/lily58/ssd1306.c **** 
 140:keyboards/lily58/ssd1306.c ****   send_cmd1(SetStartLine | 0x0);
 141:keyboards/lily58/ssd1306.c ****   send_cmd2(SetChargePump, 0x14 /* Enable */);
 142:keyboards/lily58/ssd1306.c ****   send_cmd2(SetMemoryMode, 0 /* horizontal addressing */);
 143:keyboards/lily58/ssd1306.c **** 
 144:keyboards/lily58/ssd1306.c ****   if(rotate){
 145:keyboards/lily58/ssd1306.c ****     // the following Flip the display orientation 180 degrees
 146:keyboards/lily58/ssd1306.c ****     send_cmd1(SegRemap);
 147:keyboards/lily58/ssd1306.c ****     send_cmd1(ComScanInc);
 148:keyboards/lily58/ssd1306.c ****   }else{
 149:keyboards/lily58/ssd1306.c ****     // Flips the display orientation 0 degrees
 150:keyboards/lily58/ssd1306.c ****     send_cmd1(SegRemap | 0x1);
 151:keyboards/lily58/ssd1306.c ****     send_cmd1(ComScanDec);
 152:keyboards/lily58/ssd1306.c ****   }
 153:keyboards/lily58/ssd1306.c **** 
 154:keyboards/lily58/ssd1306.c ****   send_cmd2(SetComPins, 0x2);
 155:keyboards/lily58/ssd1306.c ****   send_cmd2(SetContrast, 0x8f);
 156:keyboards/lily58/ssd1306.c ****   send_cmd2(SetPreCharge, 0xf1);
 157:keyboards/lily58/ssd1306.c ****   send_cmd2(SetVComDetect, 0x40);
 158:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayAllOnResume);
 159:keyboards/lily58/ssd1306.c ****   send_cmd1(NormalDisplay);
 160:keyboards/lily58/ssd1306.c ****   send_cmd1(DeActivateScroll);
 161:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOn);
 162:keyboards/lily58/ssd1306.c **** 
 163:keyboards/lily58/ssd1306.c ****   send_cmd2(SetContrast, 0); // Dim
 164:keyboards/lily58/ssd1306.c **** 
 165:keyboards/lily58/ssd1306.c ****   clear_display();
 166:keyboards/lily58/ssd1306.c **** 
 167:keyboards/lily58/ssd1306.c ****   success = true;
 168:keyboards/lily58/ssd1306.c **** 
 169:keyboards/lily58/ssd1306.c ****   iota_gfx_flush();
 170:keyboards/lily58/ssd1306.c **** 
 171:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 172:keyboards/lily58/ssd1306.c ****   print_set_sendchar(capture_sendchar);
 173:keyboards/lily58/ssd1306.c **** #endif
 174:keyboards/lily58/ssd1306.c **** 
 175:keyboards/lily58/ssd1306.c **** done:
 176:keyboards/lily58/ssd1306.c ****   return success;
 177:keyboards/lily58/ssd1306.c **** }
 178:keyboards/lily58/ssd1306.c **** 
 179:keyboards/lily58/ssd1306.c **** bool iota_gfx_off(void) {
 178               		.loc 1 179 0
 179               		.cfi_startproc
 180               	/* prologue: function */
 181               	/* frame size = 0 */
 182               	/* stack size = 0 */
 183               	.L__stack_usage = 0
 184               	.LVL25:
 180:keyboards/lily58/ssd1306.c ****   bool success = false;
 181:keyboards/lily58/ssd1306.c **** 
 182:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOff);
 185               		.loc 1 182 0
 186 0000 8EEA      		ldi r24,lo8(-82)
 187 0002 0C94 0000 		jmp _send_cmd1
 188               	.LVL26:
 189               		.cfi_endproc
 190               	.LFE120:
 192               		.section	.text.iota_gfx_on,"ax",@progbits
 193               	.global	iota_gfx_on
 195               	iota_gfx_on:
 196               	.LFB121:
 183:keyboards/lily58/ssd1306.c ****   success = true;
 184:keyboards/lily58/ssd1306.c **** 
 185:keyboards/lily58/ssd1306.c **** done:
 186:keyboards/lily58/ssd1306.c ****   return success;
 187:keyboards/lily58/ssd1306.c **** }
 188:keyboards/lily58/ssd1306.c **** 
 189:keyboards/lily58/ssd1306.c **** bool iota_gfx_on(void) {
 197               		.loc 1 189 0
 198               		.cfi_startproc
 199               	/* prologue: function */
 200               	/* frame size = 0 */
 201               	/* stack size = 0 */
 202               	.L__stack_usage = 0
 203               	.LVL27:
 190:keyboards/lily58/ssd1306.c ****   bool success = false;
 191:keyboards/lily58/ssd1306.c **** 
 192:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOn);
 204               		.loc 1 192 0
 205 0000 8FEA      		ldi r24,lo8(-81)
 206 0002 0C94 0000 		jmp _send_cmd1
 207               	.LVL28:
 208               		.cfi_endproc
 209               	.LFE121:
 211               		.section	.text.matrix_write_char_inner,"ax",@progbits
 212               	.global	matrix_write_char_inner
 214               	matrix_write_char_inner:
 215               	.LFB122:
 193:keyboards/lily58/ssd1306.c ****   success = true;
 194:keyboards/lily58/ssd1306.c **** 
 195:keyboards/lily58/ssd1306.c **** done:
 196:keyboards/lily58/ssd1306.c ****   return success;
 197:keyboards/lily58/ssd1306.c **** }
 198:keyboards/lily58/ssd1306.c **** 
 199:keyboards/lily58/ssd1306.c **** void matrix_write_char_inner(struct CharacterMatrix *matrix, uint8_t c) {
 216               		.loc 1 199 0
 217               		.cfi_startproc
 218               	.LVL29:
 219 0000 0F93      		push r16
 220               	.LCFI3:
 221               		.cfi_def_cfa_offset 3
 222               		.cfi_offset 16, -2
 223 0002 1F93      		push r17
 224               	.LCFI4:
 225               		.cfi_def_cfa_offset 4
 226               		.cfi_offset 17, -3
 227 0004 CF93      		push r28
 228               	.LCFI5:
 229               		.cfi_def_cfa_offset 5
 230               		.cfi_offset 28, -4
 231 0006 DF93      		push r29
 232               	.LCFI6:
 233               		.cfi_def_cfa_offset 6
 234               		.cfi_offset 29, -5
 235               	/* prologue: function */
 236               	/* frame size = 0 */
 237               	/* stack size = 4 */
 238               	.L__stack_usage = 4
 239 0008 EC01      		movw r28,r24
 200:keyboards/lily58/ssd1306.c ****   *matrix->cursor = c;
 240               		.loc 1 200 0
 241 000a 8C01      		movw r16,r24
 242 000c 0C5A      		subi r16,-84
 243 000e 1F4F      		sbci r17,-1
 244 0010 D801      		movw r26,r16
 245 0012 ED91      		ld r30,X+
 246 0014 FC91      		ld r31,X
 247 0016 1197      		sbiw r26,1
 248 0018 6083      		st Z,r22
 201:keyboards/lily58/ssd1306.c ****   ++matrix->cursor;
 249               		.loc 1 201 0
 250 001a 8D91      		ld r24,X+
 251 001c 9C91      		ld r25,X
 252 001e 1197      		sbiw r26,1
 253               	.LVL30:
 254 0020 0196      		adiw r24,1
 255 0022 8D93      		st X+,r24
 256 0024 9C93      		st X,r25
 202:keyboards/lily58/ssd1306.c **** 
 203:keyboards/lily58/ssd1306.c ****   if (matrix->cursor - &matrix->display[0][0] == sizeof(matrix->display)) {
 257               		.loc 1 203 0
 258 0026 8C1B      		sub r24,r28
 259 0028 9D0B      		sbc r25,r29
 260 002a 8435      		cpi r24,84
 261 002c 9105      		cpc r25,__zero_reg__
 262 002e 01F4      		brne .L21
 204:keyboards/lily58/ssd1306.c ****     // We went off the end; scroll the display upwards by one line
 205:keyboards/lily58/ssd1306.c ****     memmove(&matrix->display[0], &matrix->display[1],
 263               		.loc 1 205 0
 264 0030 BE01      		movw r22,r28
 265               	.LVL31:
 266 0032 6B5E      		subi r22,-21
 267 0034 7F4F      		sbci r23,-1
 268 0036 4FE3      		ldi r20,lo8(63)
 269 0038 50E0      		ldi r21,0
 270 003a CE01      		movw r24,r28
 271 003c 0E94 0000 		call memmove
 272               	.LVL32:
 206:keyboards/lily58/ssd1306.c ****             MatrixCols * (MatrixRows - 1));
 207:keyboards/lily58/ssd1306.c ****     matrix->cursor = &matrix->display[MatrixRows - 1][0];
 273               		.loc 1 207 0
 274 0040 CE01      		movw r24,r28
 275 0042 CF96      		adiw r24,63
 276 0044 F801      		movw r30,r16
 277 0046 9183      		std Z+1,r25
 278 0048 8083      		st Z,r24
 208:keyboards/lily58/ssd1306.c ****     memset(matrix->cursor, ' ', MatrixCols);
 279               		.loc 1 208 0
 280 004a 45E1      		ldi r20,lo8(21)
 281 004c 50E0      		ldi r21,0
 282 004e 60E2      		ldi r22,lo8(32)
 283 0050 70E0      		ldi r23,0
 284               	/* epilogue start */
 209:keyboards/lily58/ssd1306.c ****   }
 210:keyboards/lily58/ssd1306.c **** }
 285               		.loc 1 210 0
 286 0052 DF91      		pop r29
 287 0054 CF91      		pop r28
 288               	.LVL33:
 289 0056 1F91      		pop r17
 290 0058 0F91      		pop r16
 208:keyboards/lily58/ssd1306.c ****     memset(matrix->cursor, ' ', MatrixCols);
 291               		.loc 1 208 0
 292 005a 0C94 0000 		jmp memset
 293               	.LVL34:
 294               	.L21:
 295               	/* epilogue start */
 296               		.loc 1 210 0
 297 005e DF91      		pop r29
 298 0060 CF91      		pop r28
 299               	.LVL35:
 300 0062 1F91      		pop r17
 301 0064 0F91      		pop r16
 302               	.LVL36:
 303 0066 0895      		ret
 304               		.cfi_endproc
 305               	.LFE122:
 307               		.section	.text.matrix_write_char,"ax",@progbits
 308               	.global	matrix_write_char
 310               	matrix_write_char:
 311               	.LFB123:
 211:keyboards/lily58/ssd1306.c **** 
 212:keyboards/lily58/ssd1306.c **** void matrix_write_char(struct CharacterMatrix *matrix, uint8_t c) {
 312               		.loc 1 212 0
 313               		.cfi_startproc
 314               	.LVL37:
 315 0000 1F93      		push r17
 316               	.LCFI7:
 317               		.cfi_def_cfa_offset 3
 318               		.cfi_offset 17, -2
 319 0002 CF93      		push r28
 320               	.LCFI8:
 321               		.cfi_def_cfa_offset 4
 322               		.cfi_offset 28, -3
 323 0004 DF93      		push r29
 324               	.LCFI9:
 325               		.cfi_def_cfa_offset 5
 326               		.cfi_offset 29, -4
 327               	/* prologue: function */
 328               	/* frame size = 0 */
 329               	/* stack size = 3 */
 330               	.L__stack_usage = 3
 331 0006 EC01      		movw r28,r24
 213:keyboards/lily58/ssd1306.c ****   matrix->dirty = true;
 332               		.loc 1 213 0
 333 0008 FC01      		movw r30,r24
 334 000a EA5A      		subi r30,-86
 335 000c FF4F      		sbci r31,-1
 336 000e 81E0      		ldi r24,lo8(1)
 337               	.LVL38:
 338 0010 8083      		st Z,r24
 214:keyboards/lily58/ssd1306.c **** 
 215:keyboards/lily58/ssd1306.c ****   if (c == '\n') {
 339               		.loc 1 215 0
 340 0012 6A30      		cpi r22,lo8(10)
 341 0014 01F4      		brne .L24
 342               	.LBB24:
 216:keyboards/lily58/ssd1306.c ****     // Clear to end of line from the cursor and then move to the
 217:keyboards/lily58/ssd1306.c ****     // start of the next line
 218:keyboards/lily58/ssd1306.c ****     uint8_t cursor_col = (matrix->cursor - &matrix->display[0][0]) % MatrixCols;
 343               		.loc 1 218 0
 344 0016 3297      		sbiw r30,2
 345 0018 8081      		ld r24,Z
 346 001a 9181      		ldd r25,Z+1
 347 001c 8C1B      		sub r24,r28
 348 001e 9D0B      		sbc r25,r29
 349 0020 65E1      		ldi r22,lo8(21)
 350 0022 70E0      		ldi r23,0
 351               	.LVL39:
 352 0024 0E94 0000 		call __divmodhi4
 353 0028 182F      		mov r17,r24
 354               	.LVL40:
 355               	.L25:
 219:keyboards/lily58/ssd1306.c **** 
 220:keyboards/lily58/ssd1306.c ****     while (cursor_col++ < MatrixCols) {
 356               		.loc 1 220 0
 357 002a 1531      		cpi r17,lo8(21)
 358 002c 00F0      		brlo .L26
 359               	/* epilogue start */
 360               	.LBE24:
 221:keyboards/lily58/ssd1306.c ****       matrix_write_char_inner(matrix, ' ');
 222:keyboards/lily58/ssd1306.c ****     }
 223:keyboards/lily58/ssd1306.c ****     return;
 224:keyboards/lily58/ssd1306.c ****   }
 225:keyboards/lily58/ssd1306.c **** 
 226:keyboards/lily58/ssd1306.c ****   matrix_write_char_inner(matrix, c);
 227:keyboards/lily58/ssd1306.c **** }
 361               		.loc 1 227 0
 362 002e DF91      		pop r29
 363 0030 CF91      		pop r28
 364               	.LVL41:
 365 0032 1F91      		pop r17
 366               	.LVL42:
 367 0034 0895      		ret
 368               	.LVL43:
 369               	.L26:
 370               	.LBB25:
 221:keyboards/lily58/ssd1306.c ****       matrix_write_char_inner(matrix, ' ');
 371               		.loc 1 221 0
 372 0036 60E2      		ldi r22,lo8(32)
 373 0038 CE01      		movw r24,r28
 374 003a 0E94 0000 		call matrix_write_char_inner
 375               	.LVL44:
 376 003e 1F5F      		subi r17,lo8(-(1))
 377               	.LVL45:
 378 0040 00C0      		rjmp .L25
 379               	.LVL46:
 380               	.L24:
 381               	.LBE25:
 226:keyboards/lily58/ssd1306.c **** }
 382               		.loc 1 226 0
 383 0042 CE01      		movw r24,r28
 384               	/* epilogue start */
 385               		.loc 1 227 0
 386 0044 DF91      		pop r29
 387 0046 CF91      		pop r28
 388               	.LVL47:
 389 0048 1F91      		pop r17
 226:keyboards/lily58/ssd1306.c **** }
 390               		.loc 1 226 0
 391 004a 0C94 0000 		jmp matrix_write_char_inner
 392               	.LVL48:
 393               		.cfi_endproc
 394               	.LFE123:
 396               		.section	.text.iota_gfx_write_char,"ax",@progbits
 397               	.global	iota_gfx_write_char
 399               	iota_gfx_write_char:
 400               	.LFB124:
 228:keyboards/lily58/ssd1306.c **** 
 229:keyboards/lily58/ssd1306.c **** void iota_gfx_write_char(uint8_t c) {
 401               		.loc 1 229 0
 402               		.cfi_startproc
 403               	.LVL49:
 404               	/* prologue: function */
 405               	/* frame size = 0 */
 406               	/* stack size = 0 */
 407               	.L__stack_usage = 0
 230:keyboards/lily58/ssd1306.c ****   matrix_write_char(&display, c);
 408               		.loc 1 230 0
 409 0000 682F      		mov r22,r24
 410 0002 80E0      		ldi r24,lo8(display)
 411 0004 90E0      		ldi r25,hi8(display)
 412               	.LVL50:
 413 0006 0C94 0000 		jmp matrix_write_char
 414               	.LVL51:
 415               		.cfi_endproc
 416               	.LFE124:
 418               		.section	.text.matrix_write,"ax",@progbits
 419               	.global	matrix_write
 421               	matrix_write:
 422               	.LFB125:
 231:keyboards/lily58/ssd1306.c **** }
 232:keyboards/lily58/ssd1306.c **** 
 233:keyboards/lily58/ssd1306.c **** void matrix_write(struct CharacterMatrix *matrix, const char *data) {
 423               		.loc 1 233 0
 424               		.cfi_startproc
 425               	.LVL52:
 426 0000 EF92      		push r14
 427               	.LCFI10:
 428               		.cfi_def_cfa_offset 3
 429               		.cfi_offset 14, -2
 430 0002 FF92      		push r15
 431               	.LCFI11:
 432               		.cfi_def_cfa_offset 4
 433               		.cfi_offset 15, -3
 434 0004 0F93      		push r16
 435               	.LCFI12:
 436               		.cfi_def_cfa_offset 5
 437               		.cfi_offset 16, -4
 438 0006 1F93      		push r17
 439               	.LCFI13:
 440               		.cfi_def_cfa_offset 6
 441               		.cfi_offset 17, -5
 442 0008 CF93      		push r28
 443               	.LCFI14:
 444               		.cfi_def_cfa_offset 7
 445               		.cfi_offset 28, -6
 446 000a DF93      		push r29
 447               	.LCFI15:
 448               		.cfi_def_cfa_offset 8
 449               		.cfi_offset 29, -7
 450               	/* prologue: function */
 451               	/* frame size = 0 */
 452               	/* stack size = 6 */
 453               	.L__stack_usage = 6
 454 000c 7C01      		movw r14,r24
 455 000e EB01      		movw r28,r22
 234:keyboards/lily58/ssd1306.c ****   const char *end = data + strlen(data);
 456               		.loc 1 234 0
 457 0010 FB01      		movw r30,r22
 458               		0:
 459 0012 0190      		ld __tmp_reg__,Z+
 460 0014 0020      		tst __tmp_reg__
 461 0016 01F4      		brne 0b
 462 0018 8F01      		movw r16,r30
 463 001a 0150      		subi r16,1
 464 001c 1109      		sbc r17,__zero_reg__
 465               	.LVL53:
 466               	.L31:
 235:keyboards/lily58/ssd1306.c ****   while (data < end) {
 467               		.loc 1 235 0
 468 001e C017      		cp r28,r16
 469 0020 D107      		cpc r29,r17
 470 0022 00F0      		brlo .L32
 471               	/* epilogue start */
 236:keyboards/lily58/ssd1306.c ****     matrix_write_char(matrix, *data);
 237:keyboards/lily58/ssd1306.c ****     ++data;
 238:keyboards/lily58/ssd1306.c ****   }
 239:keyboards/lily58/ssd1306.c **** }
 472               		.loc 1 239 0
 473 0024 DF91      		pop r29
 474 0026 CF91      		pop r28
 475               	.LVL54:
 476 0028 1F91      		pop r17
 477 002a 0F91      		pop r16
 478               	.LVL55:
 479 002c FF90      		pop r15
 480 002e EF90      		pop r14
 481               	.LVL56:
 482 0030 0895      		ret
 483               	.LVL57:
 484               	.L32:
 236:keyboards/lily58/ssd1306.c ****     matrix_write_char(matrix, *data);
 485               		.loc 1 236 0
 486 0032 6991      		ld r22,Y+
 487               	.LVL58:
 488 0034 C701      		movw r24,r14
 489 0036 0E94 0000 		call matrix_write_char
 490               	.LVL59:
 491 003a 00C0      		rjmp .L31
 492               		.cfi_endproc
 493               	.LFE125:
 495               		.section	.rodata.matrix_write_ln.str1.1,"aMS",@progbits,1
 496               	.LC0:
 497 0000 2573 0A00 		.string	"%s\n"
 498               		.section	.text.matrix_write_ln,"ax",@progbits
 499               	.global	matrix_write_ln
 501               	matrix_write_ln:
 502               	.LFB126:
 240:keyboards/lily58/ssd1306.c **** 
 241:keyboards/lily58/ssd1306.c **** void matrix_write_ln(struct CharacterMatrix *matrix, const char *data) {
 503               		.loc 1 241 0
 504               		.cfi_startproc
 505               	.LVL60:
 506 0000 CF92      		push r12
 507               	.LCFI16:
 508               		.cfi_def_cfa_offset 3
 509               		.cfi_offset 12, -2
 510 0002 DF92      		push r13
 511               	.LCFI17:
 512               		.cfi_def_cfa_offset 4
 513               		.cfi_offset 13, -3
 514 0004 EF92      		push r14
 515               	.LCFI18:
 516               		.cfi_def_cfa_offset 5
 517               		.cfi_offset 14, -4
 518 0006 FF92      		push r15
 519               	.LCFI19:
 520               		.cfi_def_cfa_offset 6
 521               		.cfi_offset 15, -5
 522 0008 0F93      		push r16
 523               	.LCFI20:
 524               		.cfi_def_cfa_offset 7
 525               		.cfi_offset 16, -6
 526 000a 1F93      		push r17
 527               	.LCFI21:
 528               		.cfi_def_cfa_offset 8
 529               		.cfi_offset 17, -7
 530 000c CF93      		push r28
 531               	.LCFI22:
 532               		.cfi_def_cfa_offset 9
 533               		.cfi_offset 28, -8
 534 000e DF93      		push r29
 535               	.LCFI23:
 536               		.cfi_def_cfa_offset 10
 537               		.cfi_offset 29, -9
 538 0010 CDB7      		in r28,__SP_L__
 539 0012 DEB7      		in r29,__SP_H__
 540               	.LCFI24:
 541               		.cfi_def_cfa_register 28
 542               	/* prologue: function */
 543               	/* frame size = 0 */
 544               	/* stack size = 8 */
 545               	.L__stack_usage = 8
 546 0014 7C01      		movw r14,r24
 242:keyboards/lily58/ssd1306.c ****   char data_ln[strlen(data)+2];
 243:keyboards/lily58/ssd1306.c ****   snprintf(data_ln, sizeof(data_ln), "%s\n", data);
 244:keyboards/lily58/ssd1306.c ****   matrix_write(matrix, data_ln);
 245:keyboards/lily58/ssd1306.c **** }
 547               		.loc 1 245 0
 548 0016 0DB7      		in r16,__SP_L__
 549 0018 1EB7      		in r17,__SP_H__
 242:keyboards/lily58/ssd1306.c ****   char data_ln[strlen(data)+2];
 550               		.loc 1 242 0
 551 001a DB01      		movw r26,r22
 552               		0:
 553 001c 0D90      		ld __tmp_reg__,X+
 554 001e 0020      		tst __tmp_reg__
 555 0020 01F4      		brne 0b
 556 0022 CD01      		movw r24,r26
 557               	.LVL61:
 558 0024 861B      		sub r24,r22
 559 0026 970B      		sbc r25,r23
 560 0028 0196      		adiw r24,1
 561               	.LVL62:
 562 002a 2DB7      		in r18,__SP_L__
 563 002c 3EB7      		in r19,__SP_H__
 564 002e 281B      		sub r18,r24
 565 0030 390B      		sbc r19,r25
 566 0032 0FB6      		in __tmp_reg__,__SREG__
 567 0034 F894      		cli
 568 0036 3EBF      		out __SP_H__,r19
 569 0038 0FBE      		out __SREG__,__tmp_reg__
 570 003a 2DBF      		out __SP_L__,r18
 571 003c ADB7      		in r26,__SP_L__
 572 003e BEB7      		in r27,__SP_H__
 573 0040 1196      		adiw r26,1
 574 0042 6D01      		movw r12,r26
 575               	.LVL63:
 243:keyboards/lily58/ssd1306.c ****   matrix_write(matrix, data_ln);
 576               		.loc 1 243 0
 577 0044 7F93      		push r23
 578 0046 6F93      		push r22
 579 0048 20E0      		ldi r18,lo8(.LC0)
 580 004a 30E0      		ldi r19,hi8(.LC0)
 581 004c 3F93      		push r19
 582 004e 2F93      		push r18
 583 0050 9F93      		push r25
 584 0052 8F93      		push r24
 585 0054 DF92      		push r13
 586 0056 AF93      		push r26
 587 0058 0E94 0000 		call snprintf
 588               	.LVL64:
 244:keyboards/lily58/ssd1306.c **** }
 589               		.loc 1 244 0
 590 005c B601      		movw r22,r12
 591 005e C701      		movw r24,r14
 592 0060 0E94 0000 		call matrix_write
 593               	.LVL65:
 594               		.loc 1 245 0
 595 0064 2DB7      		in r18,__SP_L__
 596 0066 3EB7      		in r19,__SP_H__
 597 0068 285F      		subi r18,-8
 598 006a 3F4F      		sbci r19,-1
 599 006c 0FB6      		in __tmp_reg__,__SREG__
 600 006e F894      		cli
 601 0070 3EBF      		out __SP_H__,r19
 602 0072 0FBE      		out __SREG__,__tmp_reg__
 603 0074 2DBF      		out __SP_L__,r18
 604 0076 0FB6      		in __tmp_reg__,__SREG__
 605 0078 F894      		cli
 606 007a 1EBF      		out __SP_H__,r17
 607 007c 0FBE      		out __SREG__,__tmp_reg__
 608 007e 0DBF      		out __SP_L__,r16
 609               	/* epilogue start */
 610 0080 DF91      		pop r29
 611 0082 CF91      		pop r28
 612 0084 1F91      		pop r17
 613 0086 0F91      		pop r16
 614 0088 FF90      		pop r15
 615 008a EF90      		pop r14
 616               	.LVL66:
 617 008c DF90      		pop r13
 618 008e CF90      		pop r12
 619               	.LVL67:
 620 0090 0895      		ret
 621               		.cfi_endproc
 622               	.LFE126:
 624               		.section	.text.iota_gfx_write,"ax",@progbits
 625               	.global	iota_gfx_write
 627               	iota_gfx_write:
 628               	.LFB127:
 246:keyboards/lily58/ssd1306.c **** 
 247:keyboards/lily58/ssd1306.c **** void iota_gfx_write(const char *data) {
 629               		.loc 1 247 0
 630               		.cfi_startproc
 631               	.LVL68:
 632               	/* prologue: function */
 633               	/* frame size = 0 */
 634               	/* stack size = 0 */
 635               	.L__stack_usage = 0
 248:keyboards/lily58/ssd1306.c ****   matrix_write(&display, data);
 636               		.loc 1 248 0
 637 0000 BC01      		movw r22,r24
 638 0002 80E0      		ldi r24,lo8(display)
 639 0004 90E0      		ldi r25,hi8(display)
 640               	.LVL69:
 641 0006 0C94 0000 		jmp matrix_write
 642               	.LVL70:
 643               		.cfi_endproc
 644               	.LFE127:
 646               		.section	.text.matrix_write_P,"ax",@progbits
 647               	.global	matrix_write_P
 649               	matrix_write_P:
 650               	.LFB128:
 249:keyboards/lily58/ssd1306.c **** }
 250:keyboards/lily58/ssd1306.c **** 
 251:keyboards/lily58/ssd1306.c **** void matrix_write_P(struct CharacterMatrix *matrix, const char *data) {
 651               		.loc 1 251 0
 652               		.cfi_startproc
 653               	.LVL71:
 654 0000 0F93      		push r16
 655               	.LCFI25:
 656               		.cfi_def_cfa_offset 3
 657               		.cfi_offset 16, -2
 658 0002 1F93      		push r17
 659               	.LCFI26:
 660               		.cfi_def_cfa_offset 4
 661               		.cfi_offset 17, -3
 662 0004 CF93      		push r28
 663               	.LCFI27:
 664               		.cfi_def_cfa_offset 5
 665               		.cfi_offset 28, -4
 666 0006 DF93      		push r29
 667               	.LCFI28:
 668               		.cfi_def_cfa_offset 6
 669               		.cfi_offset 29, -5
 670               	/* prologue: function */
 671               	/* frame size = 0 */
 672               	/* stack size = 4 */
 673               	.L__stack_usage = 4
 674 0008 8C01      		movw r16,r24
 675 000a EB01      		movw r28,r22
 676               	.LVL72:
 677               	.L37:
 678               	.LBB26:
 679               	.LBB27:
 252:keyboards/lily58/ssd1306.c ****   while (true) {
 253:keyboards/lily58/ssd1306.c ****     uint8_t c = pgm_read_byte(data);
 680               		.loc 1 253 0
 681 000c FE01      		movw r30,r28
 682               	/* #APP */
 683               	 ;  253 "keyboards/lily58/ssd1306.c" 1
 684 000e 6491      		lpm r22, Z
 685               		
 686               	 ;  0 "" 2
 687               	.LVL73:
 688               	/* #NOAPP */
 689               	.LBE27:
 254:keyboards/lily58/ssd1306.c ****     if (c == 0) {
 690               		.loc 1 254 0
 691 0010 6623      		tst r22
 692 0012 01F0      		breq .L35
 255:keyboards/lily58/ssd1306.c ****       return;
 256:keyboards/lily58/ssd1306.c ****     }
 257:keyboards/lily58/ssd1306.c ****     matrix_write_char(matrix, c);
 693               		.loc 1 257 0
 694 0014 C801      		movw r24,r16
 695 0016 0E94 0000 		call matrix_write_char
 696               	.LVL74:
 258:keyboards/lily58/ssd1306.c ****     ++data;
 697               		.loc 1 258 0
 698 001a 2196      		adiw r28,1
 699               	.LVL75:
 700               	.LBE26:
 252:keyboards/lily58/ssd1306.c ****     uint8_t c = pgm_read_byte(data);
 701               		.loc 1 252 0
 702 001c 00C0      		rjmp .L37
 703               	.LVL76:
 704               	.L35:
 705               	/* epilogue start */
 259:keyboards/lily58/ssd1306.c ****   }
 260:keyboards/lily58/ssd1306.c **** }
 706               		.loc 1 260 0
 707 001e DF91      		pop r29
 708 0020 CF91      		pop r28
 709               	.LVL77:
 710 0022 1F91      		pop r17
 711 0024 0F91      		pop r16
 712               	.LVL78:
 713 0026 0895      		ret
 714               		.cfi_endproc
 715               	.LFE128:
 717               		.section	.text.iota_gfx_write_P,"ax",@progbits
 718               	.global	iota_gfx_write_P
 720               	iota_gfx_write_P:
 721               	.LFB129:
 261:keyboards/lily58/ssd1306.c **** 
 262:keyboards/lily58/ssd1306.c **** void iota_gfx_write_P(const char *data) {
 722               		.loc 1 262 0
 723               		.cfi_startproc
 724               	.LVL79:
 725               	/* prologue: function */
 726               	/* frame size = 0 */
 727               	/* stack size = 0 */
 728               	.L__stack_usage = 0
 263:keyboards/lily58/ssd1306.c ****   matrix_write_P(&display, data);
 729               		.loc 1 263 0
 730 0000 BC01      		movw r22,r24
 731 0002 80E0      		ldi r24,lo8(display)
 732 0004 90E0      		ldi r25,hi8(display)
 733               	.LVL80:
 734 0006 0C94 0000 		jmp matrix_write_P
 735               	.LVL81:
 736               		.cfi_endproc
 737               	.LFE129:
 739               		.section	.text.matrix_clear,"ax",@progbits
 740               	.global	matrix_clear
 742               	matrix_clear:
 743               	.LFB130:
 264:keyboards/lily58/ssd1306.c **** }
 265:keyboards/lily58/ssd1306.c **** 
 266:keyboards/lily58/ssd1306.c **** void matrix_clear(struct CharacterMatrix *matrix) {
 744               		.loc 1 266 0
 745               		.cfi_startproc
 746               	.LVL82:
 747 0000 CF93      		push r28
 748               	.LCFI29:
 749               		.cfi_def_cfa_offset 3
 750               		.cfi_offset 28, -2
 751 0002 DF93      		push r29
 752               	.LCFI30:
 753               		.cfi_def_cfa_offset 4
 754               		.cfi_offset 29, -3
 755               	/* prologue: function */
 756               	/* frame size = 0 */
 757               	/* stack size = 2 */
 758               	.L__stack_usage = 2
 759 0004 EC01      		movw r28,r24
 267:keyboards/lily58/ssd1306.c ****   memset(matrix->display, ' ', sizeof(matrix->display));
 760               		.loc 1 267 0
 761 0006 44E5      		ldi r20,lo8(84)
 762 0008 50E0      		ldi r21,0
 763 000a 60E2      		ldi r22,lo8(32)
 764 000c 70E0      		ldi r23,0
 765 000e 0E94 0000 		call memset
 766               	.LVL83:
 268:keyboards/lily58/ssd1306.c ****   matrix->cursor = &matrix->display[0][0];
 767               		.loc 1 268 0
 768 0012 FE01      		movw r30,r28
 769 0014 EC5A      		subi r30,-84
 770 0016 FF4F      		sbci r31,-1
 771 0018 D183      		std Z+1,r29
 772 001a C083      		st Z,r28
 269:keyboards/lily58/ssd1306.c ****   matrix->dirty = true;
 773               		.loc 1 269 0
 774 001c CA5A      		subi r28,-86
 775 001e DF4F      		sbci r29,-1
 776               	.LVL84:
 777 0020 81E0      		ldi r24,lo8(1)
 778 0022 8883      		st Y,r24
 779               	/* epilogue start */
 270:keyboards/lily58/ssd1306.c **** }
 780               		.loc 1 270 0
 781 0024 DF91      		pop r29
 782 0026 CF91      		pop r28
 783 0028 0895      		ret
 784               		.cfi_endproc
 785               	.LFE130:
 787               		.section	.text.iota_gfx_clear_screen,"ax",@progbits
 788               	.global	iota_gfx_clear_screen
 790               	iota_gfx_clear_screen:
 791               	.LFB131:
 271:keyboards/lily58/ssd1306.c **** 
 272:keyboards/lily58/ssd1306.c **** void iota_gfx_clear_screen(void) {
 792               		.loc 1 272 0
 793               		.cfi_startproc
 794               	/* prologue: function */
 795               	/* frame size = 0 */
 796               	/* stack size = 0 */
 797               	.L__stack_usage = 0
 273:keyboards/lily58/ssd1306.c ****   matrix_clear(&display);
 798               		.loc 1 273 0
 799 0000 80E0      		ldi r24,lo8(display)
 800 0002 90E0      		ldi r25,hi8(display)
 801 0004 0C94 0000 		jmp matrix_clear
 802               	.LVL85:
 803               		.cfi_endproc
 804               	.LFE131:
 806               		.section	.text.matrix_render,"ax",@progbits
 807               	.global	matrix_render
 809               	matrix_render:
 810               	.LFB132:
 274:keyboards/lily58/ssd1306.c **** }
 275:keyboards/lily58/ssd1306.c **** 
 276:keyboards/lily58/ssd1306.c **** void matrix_render(struct CharacterMatrix *matrix) {
 811               		.loc 1 276 0
 812               		.cfi_startproc
 813               	.LVL86:
 814 0000 8F92      		push r8
 815               	.LCFI31:
 816               		.cfi_def_cfa_offset 3
 817               		.cfi_offset 8, -2
 818 0002 9F92      		push r9
 819               	.LCFI32:
 820               		.cfi_def_cfa_offset 4
 821               		.cfi_offset 9, -3
 822 0004 AF92      		push r10
 823               	.LCFI33:
 824               		.cfi_def_cfa_offset 5
 825               		.cfi_offset 10, -4
 826 0006 BF92      		push r11
 827               	.LCFI34:
 828               		.cfi_def_cfa_offset 6
 829               		.cfi_offset 11, -5
 830 0008 CF92      		push r12
 831               	.LCFI35:
 832               		.cfi_def_cfa_offset 7
 833               		.cfi_offset 12, -6
 834 000a DF92      		push r13
 835               	.LCFI36:
 836               		.cfi_def_cfa_offset 8
 837               		.cfi_offset 13, -7
 838 000c EF92      		push r14
 839               	.LCFI37:
 840               		.cfi_def_cfa_offset 9
 841               		.cfi_offset 14, -8
 842 000e FF92      		push r15
 843               	.LCFI38:
 844               		.cfi_def_cfa_offset 10
 845               		.cfi_offset 15, -9
 846 0010 0F93      		push r16
 847               	.LCFI39:
 848               		.cfi_def_cfa_offset 11
 849               		.cfi_offset 16, -10
 850 0012 1F93      		push r17
 851               	.LCFI40:
 852               		.cfi_def_cfa_offset 12
 853               		.cfi_offset 17, -11
 854 0014 CF93      		push r28
 855               	.LCFI41:
 856               		.cfi_def_cfa_offset 13
 857               		.cfi_offset 28, -12
 858 0016 DF93      		push r29
 859               	.LCFI42:
 860               		.cfi_def_cfa_offset 14
 861               		.cfi_offset 29, -13
 862               	/* prologue: function */
 863               	/* frame size = 0 */
 864               	/* stack size = 12 */
 865               	.L__stack_usage = 12
 866 0018 8C01      		movw r16,r24
 277:keyboards/lily58/ssd1306.c ****   last_flush = timer_read();
 867               		.loc 1 277 0
 868 001a 0E94 0000 		call timer_read
 869               	.LVL87:
 870 001e 9093 0000 		sts last_flush+1,r25
 871 0022 8093 0000 		sts last_flush,r24
 278:keyboards/lily58/ssd1306.c ****   iota_gfx_on();
 872               		.loc 1 278 0
 873 0026 0E94 0000 		call iota_gfx_on
 874               	.LVL88:
 279:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 280:keyboards/lily58/ssd1306.c ****   ++displaying;
 281:keyboards/lily58/ssd1306.c **** #endif
 282:keyboards/lily58/ssd1306.c **** 
 283:keyboards/lily58/ssd1306.c ****   // Move to the home position
 284:keyboards/lily58/ssd1306.c ****   send_cmd3(PageAddr, 0, MatrixRows - 1);
 875               		.loc 1 284 0
 876 002a 63E0      		ldi r22,lo8(3)
 877 002c 82E2      		ldi r24,lo8(34)
 878 002e 0E94 0000 		call _send_cmd3.constprop.1
 879               	.LVL89:
 880 0032 8823      		tst r24
 881 0034 01F4      		brne .+2
 882 0036 00C0      		rjmp .L43
 285:keyboards/lily58/ssd1306.c ****   send_cmd3(ColumnAddr, 0, (MatrixCols * FontWidth) - 1);
 883               		.loc 1 285 0
 884 0038 6DE7      		ldi r22,lo8(125)
 885 003a 81E2      		ldi r24,lo8(33)
 886 003c 0E94 0000 		call _send_cmd3.constprop.1
 887               	.LVL90:
 888 0040 8823      		tst r24
 889 0042 01F0      		breq .L43
 890               	.LVL91:
 891               	.LBB28:
 892               	.LBB29:
 893               		.loc 2 36 0
 894 0044 88E7      		ldi r24,lo8(120)
 895 0046 0E94 0000 		call i2c_master_start
 896               	.LVL92:
 897               	.LBE29:
 898               	.LBE28:
 286:keyboards/lily58/ssd1306.c **** 
 287:keyboards/lily58/ssd1306.c ****   if (i2c_start_write(SSD1306_ADDRESS)) {
 899               		.loc 1 287 0
 900 004a 8111      		cpse r24,__zero_reg__
 901 004c 00C0      		rjmp .L43
 288:keyboards/lily58/ssd1306.c ****     goto done;
 289:keyboards/lily58/ssd1306.c ****   }
 290:keyboards/lily58/ssd1306.c ****   if (i2c_master_write(0x40)) {
 902               		.loc 1 290 0
 903 004e 80E4      		ldi r24,lo8(64)
 904 0050 0E94 0000 		call i2c_master_write
 905               	.LVL93:
 906 0054 8111      		cpse r24,__zero_reg__
 907 0056 00C0      		rjmp .L43
 908 0058 5801      		movw r10,r16
 909 005a 84E0      		ldi r24,lo8(4)
 910 005c 982E      		mov r9,r24
 911               	.LBB30:
 912               	.LBB31:
 913               	.LBB32:
 291:keyboards/lily58/ssd1306.c ****     // Data mode
 292:keyboards/lily58/ssd1306.c ****     goto done;
 293:keyboards/lily58/ssd1306.c ****   }
 294:keyboards/lily58/ssd1306.c **** 
 295:keyboards/lily58/ssd1306.c ****   for (uint8_t row = 0; row < MatrixRows; ++row) {
 296:keyboards/lily58/ssd1306.c ****     for (uint8_t col = 0; col < MatrixCols; ++col) {
 297:keyboards/lily58/ssd1306.c ****       const uint8_t *glyph = font + (matrix->display[row][col] * FontWidth);
 914               		.loc 1 297 0
 915 005e 96E0      		ldi r25,lo8(6)
 916 0060 892E      		mov r8,r25
 917               	.L45:
 918               	.LVL94:
 919               	.LBE32:
 920               	.LBE31:
 921               	.LBE30:
 276:keyboards/lily58/ssd1306.c ****   last_flush = timer_read();
 922               		.loc 1 276 0
 923 0062 F12C      		mov r15,__zero_reg__
 924 0064 E12C      		mov r14,__zero_reg__
 925               	.LVL95:
 926               	.L47:
 927               	.LBB38:
 928               	.LBB37:
 929               	.LBB36:
 930               		.loc 1 297 0
 931 0066 F501      		movw r30,r10
 932 0068 EE0D      		add r30,r14
 933 006a FF1D      		adc r31,r15
 934 006c C081      		ld r28,Z
 935 006e C89D      		mul r28,r8
 936 0070 E001      		movw r28,r0
 937 0072 1124      		clr __zero_reg__
 938               	.LVL96:
 939 0074 D12C      		mov r13,__zero_reg__
 940 0076 C12C      		mov r12,__zero_reg__
 941               	.LBB33:
 942               	.LBB34:
 943               	.LBB35:
 298:keyboards/lily58/ssd1306.c **** 
 299:keyboards/lily58/ssd1306.c ****       for (uint8_t glyphCol = 0; glyphCol < FontWidth; ++glyphCol) {
 300:keyboards/lily58/ssd1306.c ****         uint8_t colBits = pgm_read_byte(glyph + glyphCol);
 944               		.loc 1 300 0
 945 0078 C050      		subi r28,lo8(-(font))
 946 007a D040      		sbci r29,hi8(-(font))
 947               	.LVL97:
 948               	.L46:
 949               		.loc 1 300 0 is_stmt 0 discriminator 3
 950 007c FE01      		movw r30,r28
 951 007e EC0D      		add r30,r12
 952 0080 FD1D      		adc r31,r13
 953               	/* #APP */
 954               	 ;  300 "keyboards/lily58/ssd1306.c" 1
 955 0082 8491      		lpm r24, Z
 956               		
 957               	 ;  0 "" 2
 958               	.LVL98:
 959               	/* #NOAPP */
 960               	.LBE35:
 301:keyboards/lily58/ssd1306.c ****         i2c_master_write(colBits);
 961               		.loc 1 301 0 is_stmt 1 discriminator 3
 962 0084 0E94 0000 		call i2c_master_write
 963               	.LVL99:
 964 0088 8FEF      		ldi r24,-1
 965 008a C81A      		sub r12,r24
 966 008c D80A      		sbc r13,r24
 967               	.LVL100:
 968               	.LBE34:
 299:keyboards/lily58/ssd1306.c ****         uint8_t colBits = pgm_read_byte(glyph + glyphCol);
 969               		.loc 1 299 0 discriminator 3
 970 008e 86E0      		ldi r24,6
 971 0090 C816      		cp r12,r24
 972 0092 D104      		cpc r13,__zero_reg__
 973 0094 01F4      		brne .L46
 974               	.LVL101:
 975 0096 8FEF      		ldi r24,-1
 976 0098 E81A      		sub r14,r24
 977 009a F80A      		sbc r15,r24
 978               	.LVL102:
 979               	.LBE33:
 980               	.LBE36:
 296:keyboards/lily58/ssd1306.c ****       const uint8_t *glyph = font + (matrix->display[row][col] * FontWidth);
 981               		.loc 1 296 0 discriminator 2
 982 009c 85E1      		ldi r24,21
 983 009e E816      		cp r14,r24
 984 00a0 F104      		cpc r15,__zero_reg__
 985 00a2 01F4      		brne .L47
 986               	.LVL103:
 987 00a4 9A94      		dec r9
 988               	.LVL104:
 989 00a6 85E1      		ldi r24,21
 990 00a8 A80E      		add r10,r24
 991 00aa B11C      		adc r11,__zero_reg__
 992               	.LBE37:
 295:keyboards/lily58/ssd1306.c ****     for (uint8_t col = 0; col < MatrixCols; ++col) {
 993               		.loc 1 295 0 discriminator 2
 994 00ac 9110      		cpse r9,__zero_reg__
 995 00ae 00C0      		rjmp .L45
 996               	.LBE38:
 302:keyboards/lily58/ssd1306.c ****       }
 303:keyboards/lily58/ssd1306.c **** 
 304:keyboards/lily58/ssd1306.c ****       // 1 column of space between chars (it's not included in the glyph)
 305:keyboards/lily58/ssd1306.c ****       //i2c_master_write(0);
 306:keyboards/lily58/ssd1306.c ****     }
 307:keyboards/lily58/ssd1306.c ****   }
 308:keyboards/lily58/ssd1306.c **** 
 309:keyboards/lily58/ssd1306.c ****   matrix->dirty = false;
 997               		.loc 1 309 0
 998 00b0 F801      		movw r30,r16
 999 00b2 EA5A      		subi r30,-86
 1000 00b4 FF4F      		sbci r31,-1
 1001 00b6 1082      		st Z,__zero_reg__
 1002               	.LVL105:
 1003               	.L43:
 1004               	/* epilogue start */
 310:keyboards/lily58/ssd1306.c **** 
 311:keyboards/lily58/ssd1306.c **** done:
 312:keyboards/lily58/ssd1306.c ****   i2c_master_stop();
 313:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 314:keyboards/lily58/ssd1306.c ****   --displaying;
 315:keyboards/lily58/ssd1306.c **** #endif
 316:keyboards/lily58/ssd1306.c **** }
 1005               		.loc 1 316 0
 1006 00b8 DF91      		pop r29
 1007 00ba CF91      		pop r28
 1008 00bc 1F91      		pop r17
 1009 00be 0F91      		pop r16
 1010               	.LVL106:
 1011 00c0 FF90      		pop r15
 1012 00c2 EF90      		pop r14
 1013 00c4 DF90      		pop r13
 1014 00c6 CF90      		pop r12
 1015 00c8 BF90      		pop r11
 1016 00ca AF90      		pop r10
 1017 00cc 9F90      		pop r9
 1018 00ce 8F90      		pop r8
 312:keyboards/lily58/ssd1306.c **** #if DEBUG_TO_SCREEN
 1019               		.loc 1 312 0
 1020 00d0 0C94 0000 		jmp i2c_master_stop
 1021               	.LVL107:
 1022               		.cfi_endproc
 1023               	.LFE132:
 1025               		.section	.text.iota_gfx_flush,"ax",@progbits
 1026               	.global	iota_gfx_flush
 1028               	iota_gfx_flush:
 1029               	.LFB133:
 317:keyboards/lily58/ssd1306.c **** 
 318:keyboards/lily58/ssd1306.c **** void iota_gfx_flush(void) {
 1030               		.loc 1 318 0
 1031               		.cfi_startproc
 1032               	/* prologue: function */
 1033               	/* frame size = 0 */
 1034               	/* stack size = 0 */
 1035               	.L__stack_usage = 0
 319:keyboards/lily58/ssd1306.c ****   matrix_render(&display);
 1036               		.loc 1 319 0
 1037 0000 80E0      		ldi r24,lo8(display)
 1038 0002 90E0      		ldi r25,hi8(display)
 1039 0004 0C94 0000 		jmp matrix_render
 1040               	.LVL108:
 1041               		.cfi_endproc
 1042               	.LFE133:
 1044               		.section	.text.iota_gfx_init,"ax",@progbits
 1045               	.global	iota_gfx_init
 1047               	iota_gfx_init:
 1048               	.LFB119:
 129:keyboards/lily58/ssd1306.c ****   bool success = false;
 1049               		.loc 1 129 0
 1050               		.cfi_startproc
 1051               	.LVL109:
 1052 0000 1F93      		push r17
 1053               	.LCFI43:
 1054               		.cfi_def_cfa_offset 3
 1055               		.cfi_offset 17, -2
 1056 0002 CF93      		push r28
 1057               	.LCFI44:
 1058               		.cfi_def_cfa_offset 4
 1059               		.cfi_offset 28, -3
 1060 0004 DF93      		push r29
 1061               	.LCFI45:
 1062               		.cfi_def_cfa_offset 5
 1063               		.cfi_offset 29, -4
 1064               	/* prologue: function */
 1065               	/* frame size = 0 */
 1066               	/* stack size = 3 */
 1067               	.L__stack_usage = 3
 1068 0006 C82F      		mov r28,r24
 1069               	.LVL110:
 132:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOff);
 1070               		.loc 1 132 0
 1071 0008 0E94 0000 		call i2c_master_init
 1072               	.LVL111:
 133:keyboards/lily58/ssd1306.c ****   send_cmd2(SetDisplayClockDiv, 0x80);
 1073               		.loc 1 133 0
 1074 000c 8EEA      		ldi r24,lo8(-82)
 1075 000e 0E94 0000 		call _send_cmd1
 1076               	.LVL112:
 1077 0012 8111      		cpse r24,__zero_reg__
 1078 0014 00C0      		rjmp .L56
 1079               	.LVL113:
 1080               	.L58:
 130:keyboards/lily58/ssd1306.c **** 
 1081               		.loc 1 130 0
 1082 0016 C0E0      		ldi r28,0
 1083               	.LVL114:
 1084               	.L55:
 177:keyboards/lily58/ssd1306.c **** 
 1085               		.loc 1 177 0
 1086 0018 8C2F      		mov r24,r28
 1087               	/* epilogue start */
 1088 001a DF91      		pop r29
 1089 001c CF91      		pop r28
 1090 001e 1F91      		pop r17
 1091 0020 0895      		ret
 1092               	.LVL115:
 1093               	.L56:
 134:keyboards/lily58/ssd1306.c ****   send_cmd2(SetMultiPlex, DisplayHeight - 1);
 1094               		.loc 1 134 0
 1095 0022 60E8      		ldi r22,lo8(-128)
 1096 0024 85ED      		ldi r24,lo8(-43)
 1097 0026 0E94 0000 		call _send_cmd2
 1098               	.LVL116:
 1099 002a 8823      		tst r24
 1100 002c 01F0      		breq .L58
 135:keyboards/lily58/ssd1306.c **** 
 1101               		.loc 1 135 0
 1102 002e 6FE1      		ldi r22,lo8(31)
 1103 0030 88EA      		ldi r24,lo8(-88)
 1104 0032 0E94 0000 		call _send_cmd2
 1105               	.LVL117:
 1106 0036 8823      		tst r24
 1107 0038 01F0      		breq .L58
 137:keyboards/lily58/ssd1306.c **** 
 1108               		.loc 1 137 0
 1109 003a 60E0      		ldi r22,0
 1110 003c 83ED      		ldi r24,lo8(-45)
 1111 003e 0E94 0000 		call _send_cmd2
 1112               	.LVL118:
 1113 0042 8823      		tst r24
 1114 0044 01F0      		breq .L58
 140:keyboards/lily58/ssd1306.c ****   send_cmd2(SetChargePump, 0x14 /* Enable */);
 1115               		.loc 1 140 0
 1116 0046 80E4      		ldi r24,lo8(64)
 1117 0048 0E94 0000 		call _send_cmd1
 1118               	.LVL119:
 1119 004c 8823      		tst r24
 1120 004e 01F0      		breq .L58
 141:keyboards/lily58/ssd1306.c ****   send_cmd2(SetMemoryMode, 0 /* horizontal addressing */);
 1121               		.loc 1 141 0
 1122 0050 64E1      		ldi r22,lo8(20)
 1123 0052 8DE8      		ldi r24,lo8(-115)
 1124 0054 0E94 0000 		call _send_cmd2
 1125               	.LVL120:
 1126 0058 8823      		tst r24
 1127 005a 01F0      		breq .L58
 142:keyboards/lily58/ssd1306.c **** 
 1128               		.loc 1 142 0
 1129 005c 60E0      		ldi r22,0
 1130 005e 80E2      		ldi r24,lo8(32)
 1131 0060 0E94 0000 		call _send_cmd2
 1132               	.LVL121:
 1133 0064 8823      		tst r24
 1134 0066 01F0      		breq .L58
 144:keyboards/lily58/ssd1306.c ****     // the following Flip the display orientation 180 degrees
 1135               		.loc 1 144 0
 1136 0068 CC23      		tst r28
 1137 006a 01F4      		brne .+2
 1138 006c 00C0      		rjmp .L59
 146:keyboards/lily58/ssd1306.c ****     send_cmd1(ComScanInc);
 1139               		.loc 1 146 0
 1140 006e 80EA      		ldi r24,lo8(-96)
 1141 0070 0E94 0000 		call _send_cmd1
 1142               	.LVL122:
 1143 0074 8823      		tst r24
 1144 0076 01F0      		breq .L58
 147:keyboards/lily58/ssd1306.c ****   }else{
 1145               		.loc 1 147 0
 1146 0078 80EC      		ldi r24,lo8(-64)
 1147               	.L123:
 151:keyboards/lily58/ssd1306.c ****   }
 1148               		.loc 1 151 0
 1149 007a 0E94 0000 		call _send_cmd1
 1150               	.LVL123:
 1151 007e 8823      		tst r24
 1152 0080 01F0      		breq .L58
 154:keyboards/lily58/ssd1306.c ****   send_cmd2(SetContrast, 0x8f);
 1153               		.loc 1 154 0
 1154 0082 62E0      		ldi r22,lo8(2)
 1155 0084 8AED      		ldi r24,lo8(-38)
 1156 0086 0E94 0000 		call _send_cmd2
 1157               	.LVL124:
 1158 008a 8823      		tst r24
 1159 008c 01F0      		breq .L58
 155:keyboards/lily58/ssd1306.c ****   send_cmd2(SetPreCharge, 0xf1);
 1160               		.loc 1 155 0
 1161 008e 6FE8      		ldi r22,lo8(-113)
 1162 0090 81E8      		ldi r24,lo8(-127)
 1163 0092 0E94 0000 		call _send_cmd2
 1164               	.LVL125:
 1165 0096 8823      		tst r24
 1166 0098 01F4      		brne .+2
 1167 009a 00C0      		rjmp .L58
 156:keyboards/lily58/ssd1306.c ****   send_cmd2(SetVComDetect, 0x40);
 1168               		.loc 1 156 0
 1169 009c 61EF      		ldi r22,lo8(-15)
 1170 009e 89ED      		ldi r24,lo8(-39)
 1171 00a0 0E94 0000 		call _send_cmd2
 1172               	.LVL126:
 1173 00a4 8823      		tst r24
 1174 00a6 01F4      		brne .+2
 1175 00a8 00C0      		rjmp .L58
 157:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayAllOnResume);
 1176               		.loc 1 157 0
 1177 00aa 60E4      		ldi r22,lo8(64)
 1178 00ac 8BED      		ldi r24,lo8(-37)
 1179 00ae 0E94 0000 		call _send_cmd2
 1180               	.LVL127:
 1181 00b2 8823      		tst r24
 1182 00b4 01F4      		brne .+2
 1183 00b6 00C0      		rjmp .L58
 158:keyboards/lily58/ssd1306.c ****   send_cmd1(NormalDisplay);
 1184               		.loc 1 158 0
 1185 00b8 84EA      		ldi r24,lo8(-92)
 1186 00ba 0E94 0000 		call _send_cmd1
 1187               	.LVL128:
 1188 00be 8823      		tst r24
 1189 00c0 01F4      		brne .+2
 1190 00c2 00C0      		rjmp .L58
 159:keyboards/lily58/ssd1306.c ****   send_cmd1(DeActivateScroll);
 1191               		.loc 1 159 0
 1192 00c4 86EA      		ldi r24,lo8(-90)
 1193 00c6 0E94 0000 		call _send_cmd1
 1194               	.LVL129:
 1195 00ca 8823      		tst r24
 1196 00cc 01F4      		brne .+2
 1197 00ce 00C0      		rjmp .L58
 160:keyboards/lily58/ssd1306.c ****   send_cmd1(DisplayOn);
 1198               		.loc 1 160 0
 1199 00d0 8EE2      		ldi r24,lo8(46)
 1200 00d2 0E94 0000 		call _send_cmd1
 1201               	.LVL130:
 1202 00d6 8823      		tst r24
 1203 00d8 01F4      		brne .+2
 1204 00da 00C0      		rjmp .L58
 161:keyboards/lily58/ssd1306.c **** 
 1205               		.loc 1 161 0
 1206 00dc 8FEA      		ldi r24,lo8(-81)
 1207 00de 0E94 0000 		call _send_cmd1
 1208               	.LVL131:
 1209 00e2 8823      		tst r24
 1210 00e4 01F4      		brne .+2
 1211 00e6 00C0      		rjmp .L58
 163:keyboards/lily58/ssd1306.c **** 
 1212               		.loc 1 163 0
 1213 00e8 60E0      		ldi r22,0
 1214 00ea 81E8      		ldi r24,lo8(-127)
 1215 00ec 0E94 0000 		call _send_cmd2
 1216               	.LVL132:
 1217 00f0 C82F      		mov r28,r24
 1218               	.LVL133:
 1219 00f2 8823      		tst r24
 1220 00f4 01F4      		brne .+2
 1221 00f6 00C0      		rjmp .L58
 1222               	.LBB45:
 1223               	.LBB46:
  90:keyboards/lily58/ssd1306.c **** 
 1224               		.loc 1 90 0
 1225 00f8 80E0      		ldi r24,lo8(display)
 1226 00fa 90E0      		ldi r25,hi8(display)
 1227 00fc 0E94 0000 		call matrix_clear
 1228               	.LVL134:
  94:keyboards/lily58/ssd1306.c ****   send_cmd3(ColumnAddr, 0, DisplayWidth - 1);
 1229               		.loc 1 94 0
 1230 0100 63E0      		ldi r22,lo8(3)
 1231 0102 82E2      		ldi r24,lo8(34)
 1232 0104 0E94 0000 		call _send_cmd3.constprop.1
 1233               	.LVL135:
 1234 0108 8823      		tst r24
 1235 010a 01F0      		breq .L63
  95:keyboards/lily58/ssd1306.c **** 
 1236               		.loc 1 95 0
 1237 010c 6FE7      		ldi r22,lo8(127)
 1238 010e 81E2      		ldi r24,lo8(33)
 1239 0110 0E94 0000 		call _send_cmd3.constprop.1
 1240               	.LVL136:
 1241 0114 8823      		tst r24
 1242 0116 01F0      		breq .L63
 1243               	.LVL137:
 1244               	.LBB47:
 1245               	.LBB48:
 1246               		.loc 2 36 0
 1247 0118 88E7      		ldi r24,lo8(120)
 1248 011a 0E94 0000 		call i2c_master_start
 1249               	.LVL138:
 1250               	.LBE48:
 1251               	.LBE47:
  97:keyboards/lily58/ssd1306.c ****     goto done;
 1252               		.loc 1 97 0
 1253 011e 8111      		cpse r24,__zero_reg__
 1254 0120 00C0      		rjmp .L63
 100:keyboards/lily58/ssd1306.c ****     // Data mode
 1255               		.loc 1 100 0
 1256 0122 80E4      		ldi r24,lo8(64)
 1257 0124 0E94 0000 		call i2c_master_write
 1258               	.LVL139:
 1259 0128 14E0      		ldi r17,lo8(4)
 1260 012a 8823      		tst r24
 1261 012c 01F0      		breq .L65
 1262               	.L63:
 113:keyboards/lily58/ssd1306.c **** }
 1263               		.loc 1 113 0
 1264 012e 0E94 0000 		call i2c_master_stop
 1265               	.LVL140:
 1266               	.LBE46:
 1267               	.LBE45:
 169:keyboards/lily58/ssd1306.c **** 
 1268               		.loc 1 169 0
 1269 0132 0E94 0000 		call iota_gfx_flush
 1270               	.LVL141:
 1271               	.L57:
 176:keyboards/lily58/ssd1306.c **** }
 1272               		.loc 1 176 0
 1273 0136 00C0      		rjmp .L55
 1274               	.LVL142:
 1275               	.L59:
 150:keyboards/lily58/ssd1306.c ****     send_cmd1(ComScanDec);
 1276               		.loc 1 150 0
 1277 0138 81EA      		ldi r24,lo8(-95)
 1278 013a 0E94 0000 		call _send_cmd1
 1279               	.LVL143:
 1280 013e 8823      		tst r24
 1281 0140 01F4      		brne .+2
 1282 0142 00C0      		rjmp .L58
 151:keyboards/lily58/ssd1306.c ****   }
 1283               		.loc 1 151 0
 1284 0144 88EC      		ldi r24,lo8(-56)
 1285 0146 00C0      		rjmp .L123
 1286               	.LVL144:
 1287               	.L66:
 1288               	.LBB53:
 1289               	.LBB52:
 1290               	.LBB49:
 1291               	.LBB50:
 106:keyboards/lily58/ssd1306.c ****     }
 1292               		.loc 1 106 0
 1293 0148 80E0      		ldi r24,0
 1294 014a 0E94 0000 		call i2c_master_write
 1295               	.LVL145:
 105:keyboards/lily58/ssd1306.c ****       i2c_master_write(0);
 1296               		.loc 1 105 0
 1297 014e DF5F      		subi r29,lo8(-(1))
 1298               	.LVL146:
 1299 0150 D038      		cpi r29,lo8(-128)
 1300 0152 01F4      		brne .L66
 1301               	.LVL147:
 1302 0154 1150      		subi r17,lo8(-(-1))
 1303               	.LVL148:
 1304               	.LBE50:
 104:keyboards/lily58/ssd1306.c ****     for (uint8_t col = 0; col < DisplayWidth; ++col) {
 1305               		.loc 1 104 0
 1306 0156 01F0      		breq .L67
 1307               	.LVL149:
 1308               	.L65:
 1309               	.LBB51:
 105:keyboards/lily58/ssd1306.c ****       i2c_master_write(0);
 1310               		.loc 1 105 0
 1311 0158 D0E0      		ldi r29,0
 1312 015a 00C0      		rjmp .L66
 1313               	.LVL150:
 1314               	.L67:
 1315               	.LBE51:
 1316               	.LBE49:
 110:keyboards/lily58/ssd1306.c **** 
 1317               		.loc 1 110 0
 1318 015c 1092 0000 		sts display+86,__zero_reg__
 1319 0160 00C0      		rjmp .L63
 1320               	.LBE52:
 1321               	.LBE53:
 1322               		.cfi_endproc
 1323               	.LFE119:
 1325               		.section	.text.iota_gfx_task_user,"ax",@progbits
 1326               		.weak	iota_gfx_task_user
 1328               	iota_gfx_task_user:
 1329               	.LFB134:
 320:keyboards/lily58/ssd1306.c **** }
 321:keyboards/lily58/ssd1306.c **** 
 322:keyboards/lily58/ssd1306.c **** __attribute__ ((weak))
 323:keyboards/lily58/ssd1306.c **** void iota_gfx_task_user(void) {
 1330               		.loc 1 323 0
 1331               		.cfi_startproc
 1332               	/* prologue: function */
 1333               	/* frame size = 0 */
 1334               	/* stack size = 0 */
 1335               	.L__stack_usage = 0
 1336               	/* epilogue start */
 324:keyboards/lily58/ssd1306.c **** }
 1337               		.loc 1 324 0
 1338 0000 0895      		ret
 1339               		.cfi_endproc
 1340               	.LFE134:
 1342               		.section	.text.iota_gfx_task,"ax",@progbits
 1343               	.global	iota_gfx_task
 1345               	iota_gfx_task:
 1346               	.LFB135:
 325:keyboards/lily58/ssd1306.c **** 
 326:keyboards/lily58/ssd1306.c **** void iota_gfx_task(void) {
 1347               		.loc 1 326 0
 1348               		.cfi_startproc
 1349               	/* prologue: function */
 1350               	/* frame size = 0 */
 1351               	/* stack size = 0 */
 1352               	.L__stack_usage = 0
 327:keyboards/lily58/ssd1306.c ****   iota_gfx_task_user();
 1353               		.loc 1 327 0
 1354 0000 0E94 0000 		call iota_gfx_task_user
 1355               	.LVL151:
 328:keyboards/lily58/ssd1306.c **** 
 329:keyboards/lily58/ssd1306.c ****   if (display.dirty|| force_dirty) {
 1356               		.loc 1 329 0
 1357 0004 8091 0000 		lds r24,display+86
 1358 0008 8111      		cpse r24,__zero_reg__
 1359 000a 00C0      		rjmp .L126
 1360               		.loc 1 329 0 is_stmt 0 discriminator 1
 1361 000c 8091 0000 		lds r24,force_dirty
 1362 0010 8823      		tst r24
 1363 0012 01F0      		breq .L127
 1364               	.L126:
 330:keyboards/lily58/ssd1306.c ****     iota_gfx_flush();
 1365               		.loc 1 330 0 is_stmt 1
 1366 0014 0E94 0000 		call iota_gfx_flush
 1367               	.LVL152:
 331:keyboards/lily58/ssd1306.c ****     force_dirty = false;
 1368               		.loc 1 331 0
 1369 0018 1092 0000 		sts force_dirty,__zero_reg__
 1370               	.L127:
 332:keyboards/lily58/ssd1306.c ****   }
 333:keyboards/lily58/ssd1306.c **** 
 334:keyboards/lily58/ssd1306.c ****   if (timer_elapsed(last_flush) > ScreenOffInterval) {
 1371               		.loc 1 334 0
 1372 001c 8091 0000 		lds r24,last_flush
 1373 0020 9091 0000 		lds r25,last_flush+1
 1374 0024 0E94 0000 		call timer_elapsed
 1375               	.LVL153:
 1376 0028 8136      		cpi r24,97
 1377 002a 9A4E      		sbci r25,-22
 1378 002c 00F0      		brlo .L125
 335:keyboards/lily58/ssd1306.c ****     iota_gfx_off();
 1379               		.loc 1 335 0
 1380 002e 0C94 0000 		jmp iota_gfx_off
 1381               	.LVL154:
 1382               	.L125:
 1383               	/* epilogue start */
 336:keyboards/lily58/ssd1306.c ****   }
 337:keyboards/lily58/ssd1306.c **** }
 1384               		.loc 1 337 0
 1385 0032 0895      		ret
 1386               		.cfi_endproc
 1387               	.LFE135:
 1389               		.section	.text.process_record_gfx,"ax",@progbits
 1390               	.global	process_record_gfx
 1392               	process_record_gfx:
 1393               	.LFB136:
 338:keyboards/lily58/ssd1306.c **** 
 339:keyboards/lily58/ssd1306.c **** bool process_record_gfx(uint16_t keycode, keyrecord_t *record) {
 1394               		.loc 1 339 0
 1395               		.cfi_startproc
 1396               	.LVL155:
 1397               	/* prologue: function */
 1398               	/* frame size = 0 */
 1399               	/* stack size = 0 */
 1400               	.L__stack_usage = 0
 340:keyboards/lily58/ssd1306.c ****   force_dirty = true;
 1401               		.loc 1 340 0
 1402 0000 81E0      		ldi r24,lo8(1)
 1403               	.LVL156:
 1404 0002 8093 0000 		sts force_dirty,r24
 1405               	/* epilogue start */
 341:keyboards/lily58/ssd1306.c ****   return true;
 342:keyboards/lily58/ssd1306.c **** }
 1406               		.loc 1 342 0
 1407 0006 0895      		ret
 1408               		.cfi_endproc
 1409               	.LFE136:
 1411               		.section	.data.force_dirty,"aw",@progbits
 1414               	force_dirty:
 1415 0000 01        		.byte	1
 1416               		.section	.bss.last_flush,"aw",@nobits
 1419               	last_flush:
 1420 0000 0000      		.zero	2
 1421               		.comm	display,87,1
 1422               		.text
 1423               	.Letext0:
 1424               		.file 3 "/usr/local/Cellar/avr-gcc@7/7.4.0/avr/include/stdint.h"
 1425               		.file 4 "/usr/local/Cellar/avr-gcc@7/7.4.0/avr/include/stdio.h"
 1426               		.file 5 "tmk_core/common/keyboard.h"
 1427               		.file 6 "tmk_core/common/action.h"
 1428               		.file 7 "keyboards/lily58/ssd1306.h"
 1429               		.file 8 "lib/lufa/LUFA/Drivers/USB/Core/AVR8/../StdRequestType.h"
 1430               		.file 9 "lib/lufa/LUFA/Drivers/USB/Core/AVR8/../DeviceStandardReq.h"
 1431               		.file 10 "lib/lufa/LUFA/Drivers/USB/Core/USBTask.h"
 1432               		.file 11 "lib/lufa/LUFA/Drivers/USB/Core/HostStandardReq.h"
 1433               		.file 12 "tmk_core/common/report.h"
 1434               		.file 13 "tmk_core/common/host_driver.h"
 1435               		.file 14 "tmk_core/common/host.h"
 1436               		.file 15 "tmk_core/protocol/lufa/lufa.h"
 1437               		.file 16 "tmk_core/common/timer.h"
 1438               		.file 17 "/usr/local/Cellar/avr-gcc@7/7.4.0/avr/include/string.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 ssd1306.c
/var/tmp//ccIhZbJM.s:2      *ABS*:000000000000003e __SP_H__
/var/tmp//ccIhZbJM.s:3      *ABS*:000000000000003d __SP_L__
/var/tmp//ccIhZbJM.s:4      *ABS*:000000000000003f __SREG__
/var/tmp//ccIhZbJM.s:5      *ABS*:0000000000000000 __tmp_reg__
/var/tmp//ccIhZbJM.s:6      *ABS*:0000000000000001 __zero_reg__
/var/tmp//ccIhZbJM.s:12     .text._send_cmd1:0000000000000000 _send_cmd1
/var/tmp//ccIhZbJM.s:79     .text._send_cmd2:0000000000000000 _send_cmd2
/var/tmp//ccIhZbJM.s:119    .text._send_cmd3.constprop.1:0000000000000000 _send_cmd3.constprop.1
/var/tmp//ccIhZbJM.s:176    .text.iota_gfx_off:0000000000000000 iota_gfx_off
/var/tmp//ccIhZbJM.s:195    .text.iota_gfx_on:0000000000000000 iota_gfx_on
/var/tmp//ccIhZbJM.s:214    .text.matrix_write_char_inner:0000000000000000 matrix_write_char_inner
/var/tmp//ccIhZbJM.s:310    .text.matrix_write_char:0000000000000000 matrix_write_char
/var/tmp//ccIhZbJM.s:399    .text.iota_gfx_write_char:0000000000000000 iota_gfx_write_char
                            *COM*:0000000000000057 display
/var/tmp//ccIhZbJM.s:421    .text.matrix_write:0000000000000000 matrix_write
/var/tmp//ccIhZbJM.s:501    .text.matrix_write_ln:0000000000000000 matrix_write_ln
/var/tmp//ccIhZbJM.s:627    .text.iota_gfx_write:0000000000000000 iota_gfx_write
/var/tmp//ccIhZbJM.s:649    .text.matrix_write_P:0000000000000000 matrix_write_P
/var/tmp//ccIhZbJM.s:720    .text.iota_gfx_write_P:0000000000000000 iota_gfx_write_P
/var/tmp//ccIhZbJM.s:742    .text.matrix_clear:0000000000000000 matrix_clear
/var/tmp//ccIhZbJM.s:790    .text.iota_gfx_clear_screen:0000000000000000 iota_gfx_clear_screen
/var/tmp//ccIhZbJM.s:809    .text.matrix_render:0000000000000000 matrix_render
/var/tmp//ccIhZbJM.s:1419   .bss.last_flush:0000000000000000 last_flush
/var/tmp//ccIhZbJM.s:1028   .text.iota_gfx_flush:0000000000000000 iota_gfx_flush
/var/tmp//ccIhZbJM.s:1047   .text.iota_gfx_init:0000000000000000 iota_gfx_init
/var/tmp//ccIhZbJM.s:1328   .text.iota_gfx_task_user:0000000000000000 iota_gfx_task_user
/var/tmp//ccIhZbJM.s:1345   .text.iota_gfx_task:0000000000000000 iota_gfx_task
/var/tmp//ccIhZbJM.s:1414   .data.force_dirty:0000000000000000 force_dirty
/var/tmp//ccIhZbJM.s:1392   .text.process_record_gfx:0000000000000000 process_record_gfx

UNDEFINED SYMBOLS
i2c_master_start
i2c_master_write
i2c_master_stop
memmove
memset
__divmodhi4
snprintf
timer_read
font
i2c_master_init
timer_elapsed
__do_copy_data
__do_clear_bss
